(("undefined"!==typeof self?self:this).webpackJsonp=("undefined"!==typeof self?self:this).webpackJsonp||[]).push([[0],{259:function(e,t,a){e.exports=function(){return new Worker(a.p+"5bf7d4f12a278e23076a.worker.js")}},306:function(e,t,a){a(307),e.exports=a(509)},322:function(e,t,a){},327:function(e,t){},329:function(e,t){},360:function(e,t,a){},366:function(e,t,a){},367:function(e,t,a){},500:function(e,t,a){},501:function(e,t,a){},502:function(e,t,a){},503:function(e,t,a){},504:function(e,t,a){},505:function(e,t,a){},508:function(e,t,a){},509:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),i=a(20),o=a.n(i),s=a(268),c=a(3),l=a(6),u=a(10),d=a(9),h=a(11),m=a(39),p=a(257),f=a.n(p),v=a(8),g=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:24,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:101325;Object(c.a)(this,e),this.temperature=void 0,this.relativeHumidity=void 0,this.pressure=void 0,this.temperatureK=void 0,this.relativePressure=void 0,this.cHumid=void 0,this.hum=void 0,this.relativeTemperature=void 0,this.frO=void 0,this.frN=void 0,this.temperature=t,this.relativeHumidity=a,this.pressure=r,this.temperatureK=t+273.15,this.relativePressure=r/101325,this.cHumid=4.6151-6.8346*Math.pow(273.15/this.temperatureK,1.261),this.hum=this.relativeHumidity*Math.pow(10,this.cHumid)*this.relativePressure,this.relativeTemperature=this.temperatureK/293.15,this.frO=this.relativePressure*(24+40400*this.hum*(.02+this.hum)/(.391+this.hum)),this.frN=this.relativePressure*Math.pow(this.relativeTemperature,-.5)*(9+280*this.hum*Math.exp(-4.17*(Math.pow(this.relativeTemperature,-1/3)-1)))}return Object(l.a)(e,[{key:"get",value:function(e){return 8.686*e*e*(1/this.relativePressure*1.84e-11*Math.sqrt(this.relativeTemperature)+Math.pow(this.relativeTemperature,-2.5)*(1*Math.exp(-2239.1/this.temperatureK)/(this.frO+e*e/this.frO)*.01275+1*Math.exp(-3352/this.temperatureK)/(this.frN+e*e/this.frN)*.1068))}},{key:"C",get:function(){return 331+.6*this.temperature}}]),e}(),b=a(90),y=a(129),w=function(){function e(t){Object(c.a)(this,e),this.map=t}return Object(l.a)(e,[{key:"get",value:function(e){return this.map[e]}},{key:"frequencies",get:function(){return Object.keys(this.map).map(function(e){return+e})}},{key:"values",get:function(){return Object.values(this.map)}}]),e}(),E=[125,250,500,1e3,2e3,4e3],O=[63].concat(E,[8e3]);[].concat(Object(y.a)(O),[16e3]);function S(e){if(6!==e.length)throw new Error("Array must be of size 6");return new w({125:e[0],250:e[1],500:e[2],1000:e[3],2000:e[4],4000:e[5]})}var k=function(e){function t(e,a,r,n){var i;return Object(c.a)(this,t),(i=Object(u.a)(this,Object(d.a)(t).call(this,{color:n,flatShading:!0,vertexColors:v.VertexColors}))).name=e,i.absorption=a,i.scatter=r,i.defaultValues=!1,i}return Object(h.a)(t,e),t}(v.MeshPhongMaterial),j=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(d.a)(t).call(this))).materials={ceramic:new k("ceramic",S([1,1,1,2,2,2]),S([10,10,10,10,10,10]),13421772),concrete:new k("concrete",S([1,1,2,2,2,5]),S([10,10,10,10,10,10]),10066329),metal140cavity:new k("metal140cavity",S([13,11,6,5,4,4]),S([10,10,10,10,10,10]),11184810),plasterboard140cavity:new k("plasterboard140cavity",S([5,1,6,4,9,1]),S([10,10,10,10,10,10]),14540253),plasterboard15cavity:new k("plasterboard15cavity",S([11,13,5,2,2,3]),S([10,10,10,10,10,10]),14540253),sonaspray:new k("sonaspray",S([26,62,102,107,101,93]),S([10,10,10,10,10,10]),5592524),window:new k("window",S([10,4,3,2,2,2]),S([10,10,10,10,10,10]),5592524),ceiling:new k("ceiling",S([1,1,2,2,2,5]),S([10,10,10,10,10,10]),5592524),"ceiling treatment":new k("ceiling treatment",S([95,80,96,43,18,20]),S([10,10,10,10,10,10]),5592524),audience:new k("audience",S([8,13,29,53,60,64]),S([20,30,40,50,60,70]),5592524),carpet:new k("carpet",S([4,4,15,29,52,59]),S([10,10,10,10,10,10]),5592524),doors:new k("doors",S([12,9,7,3,2,1]),S([10,10,10,10,10,10]),5592524)},e.overrides={},e.restore(),e}return Object(h.a)(t,e),Object(l.a)(t,null,[{key:"getInstance",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),Object(l.a)(t,[{key:"addMaterial",value:function(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16777215*Math.random(),n=this.materials[e]=new k(e,t,a,r);return this.emit("change",this.get()),this.store(),n}},{key:"updateMaterial",value:function(e){console.log("Updating material",e),this.overrides[e.name]=new k(e.name,e.absorption,e.scatter,16777215*Math.random()),this.overrides[e.name].defaultValues=!1,this.emit("change",this.get()),this.store()}},{key:"getMaterial",value:function(e){var t=this.overrides[e];if(void 0!==t)return t;if(void 0!==(t=this.materials[e]))return t;var a=this.addMaterial(e,S([1,1,1,1,1,1]),S([10,10,10,10,10,10]));return a.defaultValues=!0,a}},{key:"get",value:function(){var e=Object.assign(this.materials,this.overrides);return Object.values(e)}},{key:"serialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.get();return Object.values(e).map(function(e){return{name:e.name,absorption:e.absorption,scatter:e.scatter}})}},{key:"unserialize",value:function(e){this.materials=this.unserializeRaw(e)}},{key:"store",value:function(){"object"===typeof localStorage&&localStorage.setItem("MaterialOverrides",JSON.stringify(this.serialize(Object.values(this.overrides))))}},{key:"restore",value:function(){if("object"===typeof localStorage){var e=localStorage.getItem("MaterialOverrides")||"[]",t=JSON.parse(e);this.overrides=this.unserializeRaw(t)}}},{key:"unserializeRaw",value:function(e){for(var t={},a=0,r=e.length;a<r;a++){var n=e[a];t[n.name]=new k(n.name,S(Object.values(n.absorption.map)),S(Object.values(n.scatter.map)),16777215*Math.random())}return t}}]),t}(b.EventEmitter);j.instance=null;var x=16,M=function(){function e(t){if(Object(c.a)(this,e),this.hits=0,this.readIndex=0,this.dataView=void 0,t.byteLength%x!==0)throw new Error("Buffer length must be multiples of REFLECTOGRAM_SIZE' ".concat(x));this.dataView=new DataView(t)}return Object(l.a)(e,[{key:"getReflection",value:function(e){return{distance:this.getDistance(e),p2:this.getP2(e),frequency:this.getFrequency(e),rayId:this.getRayId(e)}}},{key:"appendReflection",value:function(e){var t=this.hits*x;return this.dataView.setFloat32(t,e.distance,!0),this.dataView.setFloat32(t+4,e.p2,!0),this.dataView.setInt32(t+8,e.frequency,!0),this.dataView.setInt32(t+12,e.rayId,!0),this.hits++}},{key:"next",value:function(e){for(var t=[],a=this.readIndex,r=this.readIndex+e;a<r;a++)t.push(this.getReflection(a));return this.readIndex+=e,t}},{key:"getDistance",value:function(e){var t=e*x;return this.dataView.getFloat32(t,!0)}},{key:"getP2",value:function(e){var t=e*x;return this.dataView.getFloat32(t+4,!0)}},{key:"getFrequency",value:function(e){var t=e*x;return this.dataView.getInt32(t+8,!0)}},{key:"getRayId",value:function(e){var t=e*x;return this.dataView.getInt32(t+4,!0)}}]),e}(),C=1e5,I=function(e){function t(e,a,r){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,a,r))).name=void 0,n.id=void 0,n.enabled=!0,n.sharedBuffer=void 0,n.bufferView=void 0,n.id=t.id++,n.name=e,n.sharedBuffer=new SharedArrayBuffer(x*C),n.bufferView=new M(n.sharedBuffer),n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"addReflection",value:function(e){return this.bufferView.appendReflection(e)}},{key:"hits",value:function(){return this.bufferView.hits}}]),t}(v.Sphere);I.id=0;var D=function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,null,[{key:"dbSPL2Pa",value:function(e){return 2e-5*Math.pow(10,e/20)}},{key:"P2dbSPL",value:function(e){return 20*Math.log10(e/2e-5)}},{key:"P22dbSPL",value:function(t){return e.P2dbSPL(Math.sqrt(t))}}]),e}();function R(e,t,a){return a.indexOf(e)===t}Number.prototype.clamp=function(e,t){return Math.min(Math.max(this,e),t)};var L,P=!0,A=4*Float32Array.BYTES_PER_ELEMENT,F=60;!function(e){e[e.None=0]="None",e[e.Order=1]="Order",e[e.Dissipation=2]="Dissipation",e[e.Leaked=3]="Leaked"}(L||(L={}));var V=function(){function e(t){Object(c.a)(this,e),this.sharedBuffer=void 0,this.math=new v.Ray,this.vertices=void 0,this.stateDV=void 0,this.directionV3=new v.Vector3,this.originV3=new v.Vector3;var a=null;if(t instanceof SharedArrayBuffer?this.sharedBuffer=t:(a=t,this.sharedBuffer=e.alloc(a.orderLimit)),(this.sharedBuffer.byteLength-F)%A!==0)throw new Error("Invalid buffer size ".concat(this.sharedBuffer.byteLength,". Must be 'n * ").concat(A," + ").concat(F));this.stateDV=new DataView(this.sharedBuffer,this.sharedBuffer.byteLength-F,F),this.vertices=new Float32Array(this.sharedBuffer,0,(this.sharedBuffer.byteLength-F)/Float32Array.BYTES_PER_ELEMENT),null!==a?(this.frequency=a.frequency,this.stateDV.setInt32(28,a.orderLimit,P),this.stateDV.setInt32(32,a.dbSPL,P),this.causeOfDeath=L.None,this.totalDistance=0,this.order=0,this.currentP2=this.initialP2=Math.pow(D.dbSPL2Pa(this.dbSPL),2),this.setRay(a.origin,a.direction),this.stateDV.setInt32(52,e.counter++,P),this.vertices[0]=a.origin.x,this.vertices[1]=a.origin.y,this.vertices[2]=a.origin.z):(this.math.origin.set(this.stateDV.getFloat32(16,P),this.stateDV.getFloat32(20,P),this.stateDV.getFloat32(24,P)),this.math.direction.set(this.stateDV.getFloat32(4,P),this.stateDV.getFloat32(8,P),this.stateDV.getFloat32(12,P)))}return Object(l.a)(e,null,[{key:"alloc",value:function(e){return new SharedArrayBuffer(e*A+F)}}]),Object(l.a)(e,[{key:"setRay",value:function(e,t){this.stateDV.setFloat32(16,e.x,P),this.stateDV.setFloat32(20,e.y,P),this.stateDV.setFloat32(24,e.z,P),this.stateDV.setFloat32(4,t.x,P),this.stateDV.setFloat32(8,t.y,P),this.stateDV.setFloat32(12,t.z,P),this.math.set(e,t)}},{key:"origin",get:function(){return this.originV3.set(this.stateDV.getFloat32(16,P),this.stateDV.getFloat32(20,P),this.stateDV.getFloat32(24,P))}},{key:"direction",get:function(){return this.directionV3.set(this.stateDV.getFloat32(4,P),this.stateDV.getFloat32(8,P),this.stateDV.getFloat32(12,P))}},{key:"frequency",get:function(){return this.stateDV.getInt32(0,P)},set:function(e){this.stateDV.setInt32(0,e,P)}},{key:"orderLimit",get:function(){return this.stateDV.getInt32(28,P)}},{key:"dbSPL",get:function(){return this.stateDV.getInt32(32,P)}},{key:"currentP2",get:function(){return this.stateDV.getFloat32(36,P)},set:function(e){this.stateDV.setFloat32(36,e,P)}},{key:"order",get:function(){return this.stateDV.getInt32(40,P)},set:function(e){this.stateDV.setInt32(40,e,P)}},{key:"totalDistance",get:function(){return this.stateDV.getFloat32(44,P)},set:function(e){this.stateDV.setFloat32(44,e,P)}},{key:"initialP2",get:function(){return this.stateDV.getFloat32(48,P)},set:function(e){this.stateDV.setFloat32(48,e,P)}},{key:"id",get:function(){return this.stateDV.getInt32(52,P)}},{key:"alive",get:function(){return this.causeOfDeath===L.None}},{key:"causeOfDeath",get:function(){return this.stateDV.getInt32(56,P)},set:function(e){this.stateDV.setInt32(56,e,P)}}]),e}();V.counter=0;var N=Math.pow(2e-5,2),T=function(e){function t(){var e,a;Object(c.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(n)))).randomUnitVector=new v.Vector3,a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"reflect",value:function(e,t,a,r){var n=this.currentP2;if(!this.checkPulse())return n;var i=this.order+1,o=this.math.origin.distanceTo(e);this.totalDistance+=o,this.vertices[4*i+0]=e.x,this.vertices[4*i+1]=e.y,this.vertices[4*i+2]=e.z,this.vertices[4*i+3]=t.id;var s=r.get(this.frequency)*o;n/=Math.pow(10,s/10);var c=t.material.absorption.get(this.frequency)/100;n*=1-(c=c>1?1:c),this.currentP2=n;var l=this.math.direction.reflect(a).normalize();return this.scatter(l,t.material,a),this.setRay(e,l),this.order=i,this.currentP2}},{key:"meanFreePath",value:function(){return this.totalDistance/this.order}},{key:"toInfinity",value:function(){this.causeOfDeath=L.Leaked}},{key:"scatter",value:function(e,t,a){var r=t.scatter.get(this.frequency);if(void 0===r)throw new Error("Unknown scatter band for the ray ".concat(this.frequency));this.randomUnitVector.setFromSphericalCoords(1,2*Math.PI*Math.random()-Math.PI,2*Math.PI*Math.random()-Math.PI),this.randomUnitVector.dot(a)<0&&this.randomUnitVector.multiplyScalar(-1),e.multiplyScalar((100-r)/100),this.randomUnitVector.multiplyScalar(r/100),e.add(this.randomUnitVector),e.normalize()}},{key:"checkPulse",value:function(){return!!this.alive&&(this.order>this.orderLimit?(this.causeOfDeath=L.Order,!1):!(this.currentP2<N)||(this.causeOfDeath=L.Dissipation,!1))}}],[{key:"sscatter",value:function(e,a,r){t.rndUnitVector.setFromSphericalCoords(1,2*Math.PI*Math.random()-Math.PI,2*Math.PI*Math.random()-Math.PI),t.rndUnitVector.dot(a)<0&&t.rndUnitVector.multiplyScalar(-1);var n=e.clone();return n.multiplyScalar((100-r)/100),t.rndUnitVector.multiplyScalar(r/100),n.add(t.rndUnitVector),n.normalize(),n}}]),t}(V);T.rndUnitVector=new v.Vector3;var B,W=function(){function e(t,a){Object(c.a)(this,e),this.name=t,this.position=a,this.enabled=!0,this.name=t,this.position=a}return Object(l.a)(e,[{key:"emit",value:function(e){var t={direction:this.randomDirection(),frequency:this.randomFrequency(e),origin:this.position.clone(),dbSPL:100,orderLimit:1e3};return new T(t)}},{key:"randomFrequency",value:function(e){return e[Math.floor(Math.random()*e.length)]}},{key:"randomDirection",value:function(){return new v.Vector3(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1).normalize()}}]),e}(),U=function(e){function t(e,a,r){var n,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Object(c.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,a,r))).isFloor=i,n.sid=void 0,n.isAcousticSurface=!0,n.sid=e,a.computeFaceNormals(),a.computeBoundingBox(),n}return Object(h.a)(t,e),t}(v.Mesh),z={3:new(function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,[{key:"load",value:function(e,t){var a=e;if(3!==e.version)throw console.error("Loader v3 is used for file with version",e.version),new Error("Loader version mismatch");t.modelInit();for(var r=[],n=[],i=[],o=0,s=a.surfaces.length;o<s;o++){for(var c=new v.Geometry,l=a.surfaces[o],u=0,d=l.vertices.length;u<d;u++){var h=l.vertices[u];c.vertices.push(new v.Vector3(h[0],h[1],h[2]))}for(var m=0,p=l.faces.length;m<p;m++){var f=l.faces[m];c.faces.push(new v.Face3(f[2],f[1],f[0]))}var g=l.material.split("$"),b=!1,y=g[0];2===g.length&&(b="floor"===g[1]);var w=new U(o,c,j.getInstance().getMaterial(y),b);r.push(w),t.addSurface(w)}for(var E=0,O=a.receivers.length;E<O;E++){var S=a.receivers[E],k=S.position,x=new I(S.name||"R".concat(E),new v.Vector3(k[0],k[1],k[2]),.5);n.push(x),t.addReceiver(x)}for(var M=0,C=a.sources.length;M<C;M++){var D=a.sources[M],R=D.position,L=new W(D.name||"S".concat(M),new v.Vector3(R[0],R[1],R[2]));i.push(L),t.addSource(L)}return t.modelDone(),{surfaces:r,receivers:n,sources:i}}},{key:"getVertices",value:function(e){return[]}}]),e}())},G=function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,null,[{key:"load",value:function(e,t){var a=z[e.version];if(void 0===a)throw console.error("I don't have any loader for model file version: ",e.version),new Error("No loader for file version");return a.load(e,t)}}]),e}(),H=function(){function e(t){if(Object(c.a)(this,e),this.incremental={},this.receiversNames=[],this.buffers=[],this.receivers={},0!==t.length){this.buffers=t,this.receiversNames=Object.keys(t[0]);for(var a=0,r=t.length;a<r;a++)for(var n=t[a],i=0,o=this.receiversNames.length;i<o;i++){var s=this.receiversNames[i];void 0===this.receivers[s]&&(this.receivers[s]=[],this.incremental[s]=[]);var l=new M(n[s]);this.receivers[s].push(l)}}}return Object(l.a)(e,[{key:"generate",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return!0},r=this.receivers[e];if(void 0===r)return console.warn("Unknown receiver"),[];for(var n=[],i=0,o=r.length;i<o;i++)for(var s=r[i],c=0;c<C;c++){var l=s.getReflection(c);if(0===l.distance)break;!1!==a(l)&&n.push(t(l))}return n}},{key:"accumulate",value:function(e){}},{key:"diff",value:function(e){if(0===e.length)return{};for(var t={},a=Object.keys(e[0]),r=0,n=a.length;r<n;r++)t[a[r]]=[];for(var i=0,o=e.length;i<o;i++)for(var s=e[i],c=0,l=a.length;c<l;c++){var u,d=a[c],h=s[d],m=this.receivers[d];if(void 0===m)return console.error("No reflectogram viewer for the diff map"),{};var p=m[i];(u=t[d]).push.apply(u,Object(y.a)(p.next(h)))}return t}}]),e}(),_=a(96),q=a.n(_),J=a(258),X=a.n(J),Y=a(259),K=a.n(Y);!function(e){e.LoadModel="LoadModel",e.SyncMaterials="SyncMaterials",e.SetEnvironment="SetEnvironment",e.Clear="Clear",e.Excite="Excite",e.Iterate="Iterate",e.Run="Run",e.Init="Init"}(B||(B={}));var Z=function(){function e(){Object(c.a)(this,e),this.threads=[],this.rays=[],this.excited=!1,this.order=0,this.model=void 0;for(var t=0,a=navigator.hardwareConcurrency;t<a;t++){var r=new X.a(new K.a);this.threads.push(r),r.postMessage({command:B.Init,threadId:t})}}return Object(l.a)(e,[{key:"setEnvironment",value:function(e,t){return this.sendCommand({command:B.SetEnvironment,humidity:t,temperature:e})}},{key:"clearRays",value:function(){this.sendCommand({command:B.Clear})}},{key:"excite",value:function(e,t){var a=this,r=Math.floor(t/this.threads.length);return this.sendCommand({command:B.Excite,numberOfRays:r,sources:e}).then(function(e){for(var t=e.replies,r=t[0].rays,n=[t[0].reflectogramsPerRececiver],i=1,o=t.length;i<o;i++)r=r.concat(t[i].rays),n.push(t[i].reflectogramsPerRececiver);return a.excited=!0,a.rays=r,{rays:r,reflectogramsPerThread:n}})}},{key:"syncMaterials",value:function(e){return this.sendCommand({command:B.SyncMaterials,materials:e})}},{key:"iterate",value:function(){var e=this;return this.sendCommand({command:B.Iterate}).then(function(t){for(var a=t.replies,r=a[0],n=r.order,i=[r.hitsDiffPerReceiver],o=0,s=0,c=a.length;s<c;s++){var l=a[s];if(o+=l.dead,n!==l.order)return console.warn("Mismatched order report from threads.",n,l.order),{command:B.Iterate,success:!1};i.push(l.hitsDiffPerReceiver)}return e.order=n,{command:B.Iterate,dead:o,hitsDiffsPerThread:i,order:n}})}},{key:"run",value:function(e){this.sendCommand({command:B.Excite,iterations:e})}},{key:"loadModel",value:function(e){return this.model=e,this.excited=!1,this.sendCommand({command:B.LoadModel,model:e})}},{key:"sendCommand",value:function(e){for(var t=[],a=0,r=this.threads.length;a<r;a++)t.push(e);return this.sendCommands(t)}},{key:"sendCommands",value:function(e){if(e.length!==this.threads.length)throw new Error("Message count does not match thread count");for(var t=[],a=0,r=e.length;a<r;a++)t.push(this.postMessage(a,e[a]));return _.Promise.all(t).then(function(e){for(var t=!0,a=0,r=e.length;a<r;a++){return!1===e[a].success&&(t=!1),{replies:e,success:t}}})}},{key:"postMessage",value:function(e,t){return this.threads[e].postMessage(t)}}]),e}(),$=a(161),Q=a(19),ee=a(113),te=a(168),ae=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).jobCounter=0,a.state={jobs:[]},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"addJob",value:function(e){var t=this.jobCounter++;return this.setState(function(a,r){var n=a.jobs;return e.id=t,{jobs:n.concat(e)}}),this.forceUpdate(),t}},{key:"updateJob",value:function(e,t){var a=this.state.jobs,r=a.findIndex(function(t){return t.id===e});if(-1!==r){var n=a[r];a[r]=Object.assign(n,t),this.setState({jobs:a}),this.forceUpdate()}else console.warn("JobID does not exist",e)}},{key:"removeJob",value:function(e){var t=this.state.jobs.findIndex(function(t){return t.id===e}),a=[];(a=a.concat(this.state.jobs)).splice(t,1),this.setState({jobs:a}),this.forceUpdate()}},{key:"getJob",value:function(e){var t=this.state.jobs.find(function(t){return t.id===e});if(void 0!==t)return Object.assign({},t)}},{key:"render",value:function(){return n.a.createElement($.a,{position:Q.a.BOTTOM_RIGHT},this.state.jobs.map(function(e){return n.a.createElement(ee.a,{timeout:0,key:e.id,message:n.a.createElement(te.a,{value:e.progress})})}))}}]),t}(n.a.PureComponent),re=(a(322),a(47)),ne=(a(515),a(118)),ie=a(119),oe=a(116),se=a(59),ce=a(22),le=a(57),ue=a(194),de=a(193),he=a(115),me=a(27),pe=a(48),fe=a(123),ve=a.n(fe);function ge(){return(ge=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function be(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var ye=n.a.createElement("path",{fill:"#FFFFFF",d:"M6.5,5h-6c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1h6c0.6,0,1,0.4,1,1v3C7.5,4.6,7,5,6.5,5z"}),we=n.a.createElement("path",{fill:"#FFFFFF",d:"M15.4,5h-6c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1h6c0.6,0,1,0.4,1,1v3C16.4,4.6,16,5,15.4,5z"}),Ee=n.a.createElement("path",{fill:"#FFFFFF",d:"M11.2,10.5H4.7c-0.6,0-1-0.4-1-1v-3c0-0.6,0.4-1,1-1h6.4c0.6,0,1,0.4,1,1v3C12.2,10.1,11.7,10.5,11.2,10.5z"}),Oe=n.a.createElement("path",{fill:"#FFFFFF",d:"M20,10.5h-6c-0.6,0-1-0.4-1-1v-3c0-0.6,0.4-1,1-1h6c0.6,0,1,0.4,1,1v3C21,10.1,20.5,10.5,20,10.5z"}),Se=n.a.createElement("path",{fill:"#FFFFFF",d:"M1.8,10.5h-6c-0.6,0-1-0.4-1-1v-3c0-0.6,0.4-1,1-1h6c0.6,0,1,0.4,1,1v3C2.8,10.1,2.4,10.5,1.8,10.5z"}),ke=n.a.createElement("path",{fill:"#FFFFFF",d:"M6.5,16h-6c-0.6,0-1-0.4-1-1v-3c0-0.6,0.4-1,1-1h6c0.6,0,1,0.4,1,1v3C7.5,15.6,7,16,6.5,16z"}),je=n.a.createElement("path",{fill:"#FFFFFF",d:"M15.4,16h-6c-0.6,0-1-0.4-1-1v-3c0-0.6,0.4-1,1-1h6c0.6,0,1,0.4,1,1v3C16.4,15.6,16,16,15.4,16z"}),xe=function(e){var t=e.svgRef,a=be(e,["svgRef"]);return n.a.createElement("svg",ge({id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 16 16",enableBackground:"new 0 0 16 16",xmlSpace:"preserve",ref:t},a),ye,we,Ee,Oe,Se,ke,je)},Me=n.a.forwardRef(function(e,t){return n.a.createElement(xe,ge({svgRef:t},e))});a.p;function Ce(){return(Ce=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Ie(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var De=n.a.createElement("style",{type:"text/css"},"\n\t.st0{fill:#FFFFFF;}\n"),Re=n.a.createElement("g",{id:"Layer_1"}),Le=n.a.createElement("g",{id:"Layer_2"},n.a.createElement("path",{className:"st0",d:"M-237.7,252c0,0.3,0,0.7,0,1c0.7,0,1.5,0,2.2,0c0,0.4,0,0.8,0,1.2c-0.7,0-1.5,0-2.2,0c0,0.3,0,0.6,0,1 c0.7,0,1.5,0,2.2,0c0,0.4,0,0.8,0,1.2c-0.7,0-1.5,0-2.2,0c0,0.3,0,0.7,0,1c0.7,0,1.5,0,2.2,0c-0.1,0.7-0.4,1.2-0.8,1.7 c-0.6,0.7-1.3,1.2-2.3,1.3c-2.1,0.3-3.7-1.2-3.9-3c0.7,0,1.5,0,2.2,0c0-0.3,0-0.7,0-1c-0.7,0-1.5,0-2.2,0c0-0.4,0-0.8,0-1.2 c0.7,0,1.5,0,2.2,0c0-0.3,0-0.6,0-1c-0.7,0-1.5,0-2.2,0c0-0.4,0-0.8,0-1.2c0.7,0,1.5,0,2.2,0c0-0.3,0-0.6,0-1c-0.7,0-1.5,0-2.2,0 c0.1-1.3,1.3-3,3.4-3c2.1,0,3.4,1.6,3.5,3C-236.2,252-237,252-237.7,252z"}),n.a.createElement("path",{className:"st0",d:"M-238.5,262.4c0,0.5,0,1,0,1.5c0.8,0,1.6,0,2.5,0c0,0.4,0,0.7,0,1c-2,0-4,0-6,0c0-0.3,0-0.7,0-1 c0.8,0,1.6,0,2.5,0c0-0.5,0-1,0-1.5c-0.2,0-0.4-0.1-0.6-0.1c-1.7-0.4-2.9-1.3-3.8-2.8c-0.4-0.8-0.6-1.6-0.6-2.5 c0-0.3,0.2-0.5,0.5-0.5c0.3,0,0.5,0.2,0.6,0.5c0,0.1,0,0.2,0,0.2c0,0.5,0.1,0.9,0.2,1.3c0.6,1.5,1.7,2.5,3.3,2.8 c2.2,0.5,4.4-0.8,5.1-2.9c0.1-0.4,0.2-0.8,0.2-1.3c0-0.1,0-0.2,0-0.3c0.1-0.2,0.3-0.4,0.6-0.3c0.2,0,0.4,0.3,0.4,0.5 c0,0.6-0.1,1.2-0.3,1.8c-0.7,1.8-2,2.9-3.8,3.5c-0.2,0.1-0.4,0.1-0.6,0.1C-238.3,262.4-238.4,262.4-238.5,262.4z"})),Pe=function(e){var t=e.svgRef,a=Ie(e,["svgRef"]);return n.a.createElement("svg",Ce({x:"0px",y:"0px",viewBox:"-247 249 16 16",style:{enableBackground:"new -247 249 16 16"},xmlSpace:"preserve",ref:t},a),De,Re,Le)},Ae=n.a.forwardRef(function(e,t){return n.a.createElement(Pe,Ce({svgRef:t},e))});a.p;function Fe(){return(Fe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Ve(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var Ne=n.a.createElement("style",{type:"text/css"},"\n\t.st0{fill:#FFFFFF;}\n"),Te=n.a.createElement("g",{id:"XMLID_15_"},n.a.createElement("path",{id:"XMLID_32_",className:"st0",d:"M4.6,12.6c-0.1,0-0.1,0-0.1-0.1c-0.1-0.2-1.9-5.8-2-6.2c0,0,0-0.1,0-0.1c0.3-0.3,0.7-0.5,1-0.8 c0.5-0.3,3.8-2.6,4.3-3C8,2.3,8,2.4,8.3,2.6c0.4,0.3,4.4,3.1,5.1,3.6c0.2,0.1,0.2,0.2,0.1,0.4c-0.2,0.6-2,5.8-2.1,6 c0,0-0.1,0.1-0.1,0.1C10.2,12.6,5.7,12.6,4.6,12.6z M8,4.2c-2,0-3.7,1.6-3.7,3.6s1.7,3.6,3.7,3.6s3.7-1.6,3.7-3.6S10,4.2,8,4.2z"}),n.a.createElement("path",{id:"XMLID_29_",className:"st0",d:"M7.8,1.9c0,0,0,0.1-0.1,0.1C7.1,2.4,2.2,5.9,2.1,5.9c-0.1,0-0.2,0-0.4,0 C1.4,5.7,0.3,5.4,0.2,5.4c0,0,0-0.1,0-0.1C0.6,4.7,2.4,2.2,3,1.6c0.1-0.1,0.3-0.2,0.5-0.3c0.2-0.1,1.8-0.6,2-0.6 C5.7,0.6,7.4,0.1,7.6,0c0.2-0.1,0.2,0.1,0.2,0.2C7.8,0.5,7.8,1.6,7.8,1.9z M4.4,1.7c-1,0.7-2.2,1.7-2.5,2.5 C1.5,5.3,3.2,4.7,5.1,3.1C6.4,2,6.7,1.1,6.3,1C6,0.9,5.2,1.2,4.4,1.7z"}),n.a.createElement("path",{id:"XMLID_26_",className:"st0",d:"M4.1,12.8C4,12.8,4,12.9,4,12.9c-0.3,0.4-0.6,0.8-1,1.3c-0.1,0.1-0.1,0.1-0.1,0 c-0.5-0.6-2.6-3.4-2.8-3.7c-0.1-0.1,0-0.3,0-0.4c0-1.4,0-2.9,0-4.3c0,0,0.1-0.1,0.1-0.1c0.4,0.1,1.6,0.5,1.8,0.5C2,6.4,2,6.5,2,6.6 c0.1,0.4,1.9,5.6,2,5.9C4,12.6,4.1,12.7,4.1,12.8z M0.7,7.5c-0.5,0.2-0.4,1.5,0.1,2.9s1.4,2.5,1.9,2.3c0.5-0.2,0.4-1.5-0.1-2.9 S1.2,7.3,0.7,7.5z"}),n.a.createElement("ellipse",{id:"XMLID_7_",className:"st0",cx:7.9,cy:7.8,rx:.7,ry:.6}),n.a.createElement("path",{id:"XMLID_22_",className:"st0",d:"M8.3,0.1C8.3,0,8.3,0,8.5,0c0.3,0.1,4.2,1.3,4.5,1.5c0.2,0.1,2.6,3.3,2.8,3.7 c0.1,0.1,0.1,0.1-0.1,0.2c-0.3,0.1-1.3,0.4-1.5,0.5c-0.2,0.1-0.4,0-0.6-0.1C13.2,5.5,9,2.5,8.4,2.1c0,0-0.1-0.1-0.1-0.2 C8.3,1.6,8.3,0.4,8.3,0.1z M9.3,1.1C9,1.5,9.8,2.7,11.2,3.7s2.8,1.5,3.1,1.1c0.3-0.4-0.5-1.6-1.9-2.6S9.7,0.7,9.3,1.1z"}),n.a.createElement("path",{id:"XMLID_19_",className:"st0",d:"M16,10.5c0,0.1-2.7,3.6-2.8,3.8c0,0-0.1,0-0.1,0c-0.3-0.3-0.9-1.2-1.1-1.3 c-0.1-0.1-0.1-0.3-0.1-0.4c0.1-0.3,1-2.9,1.1-3.1c0.1-0.3,0.8-2.5,1-2.9c0-0.1,0.2-0.2,0.3-0.2c0.5-0.2,1-0.3,1.5-0.5 c0.1,0,0.1,0,0.1,0.1c0,0.8,0,1.5,0,2.3C16,8.2,16,9.7,16,10.5z M15.3,6.6c-0.5-0.1-1.3,1.3-1.9,3.2s-0.7,3.5-0.3,3.6 c0.5,0.1,1.3-1.3,1.9-3.2S15.8,6.8,15.3,6.6z"}),n.a.createElement("path",{id:"XMLID_16_",className:"st0",d:"M11.4,13c0,0,0.1,0,0.1,0.1c0.3,0.4,1,1.3,1,1.3c0.1,0.2,0.1,0.2-0.1,0.3 C12,14.8,8.7,15.8,8.2,16c-0.3,0.1-0.6,0-0.9-0.1c-0.3-0.1-3.7-1.2-3.9-1.3c0,0-0.1-0.1,0-0.1c0.4-0.5,0.7-1,1.1-1.4 c0,0,0.1-0.1,0.1-0.1C5.7,13,10.3,13,11.4,13z M8,13.4c-1.7,0-3.1,0.4-3.1,0.9c0,0.5,1.4,0.9,3.1,0.9s3.1-0.4,3.1-0.9 C11.1,13.9,9.7,13.4,8,13.4z"})),Be=n.a.createElement("polygon",{id:"XMLID_14_",className:"st0",points:"0.2,22.8 -1.6,22.3 2.6,13.7 3.7,14.5 "}),We=n.a.createElement("polygon",{id:"XMLID_17_",className:"st0",points:"14,23.7 15.8,23.2 13.2,13.7 12.1,14.5 "}),Ue=function(e){var t=e.svgRef,a=Ve(e,["svgRef"]);return n.a.createElement("svg",Fe({id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 16 16",style:{enableBackground:"new 0 0 16 16"},xmlSpace:"preserve",ref:t},a),Ne,Te,Be,We)},ze=n.a.forwardRef(function(e,t){return n.a.createElement(Ue,Fe({svgRef:t},e))});a.p;function Ge(){return(Ge=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function He(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var _e=n.a.createElement("style",{type:"text/css"},"\n\t.st0{fill:#FFFFFF;}\n"),qe=n.a.createElement("polygon",{id:"XMLID_1_",className:"st0",points:"9.3,11.6 0,16 0,4.4 9.3,0 "}),Je=n.a.createElement("rect",{id:"XMLID_2_",x:9.5,y:0,className:"st0",width:6.5,height:11.6}),Xe=function(e){var t=e.svgRef,a=He(e,["svgRef"]);return n.a.createElement("svg",Ge({id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 16 16",style:{enableBackground:"new 0 0 16 16"},xmlSpace:"preserve",ref:t},a),_e,qe,Je)},Ye=n.a.forwardRef(function(e,t){return n.a.createElement(Xe,Ge({svgRef:t},e))}),Ke=(a.p,function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,null,[{key:"readArrayBuffer",value:function(e){return new q.a(function(t,a){var r=new FileReader;r.readAsArrayBuffer(e),r.onload=function(){null===r.result&&a("FileReader.result is null"),t(r.result)},r.onerror=r.onabort=a})}},{key:"readString",value:function(e){return new q.a(function(t,a){var r=new FileReader;r.readAsText(e),r.onload=function(){null===r.result&&a("FileReader.result is null"),t(r.result)},r.onerror=r.onabort=a})}}]),e}()),Ze=a(124),$e=a(33),Qe=a(157),et=a.n(Qe),tt=function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,null,[{key:"tesselate",value:function(t){var a,r=e.v2f(t),n=(e.windingOrder(r,0,r.length,3),et.a(r,void 0,3));if(n.length>0)return n;e.rotateAndArea(t,e.rotations.x)>e.rotateAndArea(t,e.rotations.y)?(a=e.rotations.x,a=e.rotations.x):(a=e.rotations.y,a=e.rotations.y);for(var i=[],o=0,s=t.length;o<s;o++){var c=t[o];i.push(c.clone().applyEuler(a))}return(n=et.a(e.v2f(i),void 0,3)).length>0?n:[]}},{key:"windingOrder",value:function(e,t,a,r){for(var n=0,i=t,o=a-r;i<a;i+=r)n+=(e[o]-e[i])*(e[i+1]+e[o+1]),o=i;return n>0}},{key:"v2f",value:function(e){for(var t=[],a=0,r=e.length;a<r;a++){var n=e[a];t.push(n.x,n.y,n.z)}return t}},{key:"rotateAndArea",value:function(t,a){for(var r=[],n=0,i=t.length;n<i;n++){var o=t[n];r.push(o.clone().applyEuler(a))}return Math.abs(e.signedPolygonArea3D(r))}},{key:"signedPolygonArea",value:function(e,t,a,r){for(var n=0,i=t,o=a-r;i<a;i+=r)n+=(e[o]-e[i])*(e[i+1]+e[o+1]),o=i;return n}},{key:"signedPolygonArea3D",value:function(t){var a=e.v2f(t);return e.signedPolygonArea(a,0,a.length,3)}}]),e}();tt.rotations={_x:new v.Euler(-Math.PI/2,0,0,"XYZ"),_y:new v.Euler(0,-Math.PI/2,0,"XYZ"),x:new v.Euler(Math.PI/2,0,0,"XYZ"),y:new v.Euler(0,Math.PI/2,0,"XYZ")};var at=function(){function e(t){Object(c.a)(this,e),this.model={signature:"XAAT",version:3,surfaces:[],receivers:[],sources:[]},this.corners=[],this.materials=[];for(var a,r=t.split("\n");void 0!==(a=r.shift());){0;var n=(a=a.trim()).toLocaleLowerCase();n.startsWith(";")||(n.startsWith("abs")?this.readABS(a):n.startsWith("corners")?this.readCorners(r):n.startsWith("planes")&&this.readPlanes(r))}}return Object(l.a)(e,[{key:"readABS",value:function(e){var t=/((\d+)?[.,]?\d+)/g,a=e.match(/^ABS\s+(\w+)\s*=\s*<([^>]*)\>\s*(\w)\s*<([^>]*)\>/i);if(null===a)throw new Error("Error parsing ABS line: ".concat(e));var r=Object($e.a)(a,5),n=r[1],i=r[2],o=(r[3],r[4]),s=i.match(t);if(null===s)throw new Error("Error parsing absorption values: ".concat(i));var c=s.map(function(e){return parseFloat(e.replace(",","."))}),l=o.match(t);if(null===l)throw new Error("Error parsing scatter values: ".concat(o));var u=l.map(function(e){return parseFloat(e.replace(",","."))});this.materials.push({name:n,defaultValues:!1,absorption:S(c),scatter:S(u)})}},{key:"readCorners",value:function(e){for(var t,a=/(-?\d?[.,]?\d)+/g;void 0!==(t=e.shift());)if(0,""!==(t=t.trim())&&!t.startsWith(";")){var r=t.match(a);if(null===r||4!==r.length)return void e.unshift(t);var n=r.map(function(e){return parseFloat(e.replace(",","."))}),i=Object(Ze.a)(n),o=(i[0],i.slice(1));this.corners.push(o)}}},{key:"readPlanes",value:function(e){for(var t,a=this,r=/^\[\s*(\d+)\s*([^\/\\]+)([\/\\])\s*([^\/\\]+)([\/\\])\s*([^\]]+)\s*\]/,n=/\d+/g;void 0!==(t=e.shift());)if(0,""!==(t=t.trim())&&!t.startsWith(";")){if(!t.startsWith("["))return void e.unshift(t);var i=t.match(r);if(null===i||7!==i.length)throw new Error("Could not parse line ".concat(t));var o=Object($e.a)(i,7),s=(o[0],o[1],o[2],o[3]),c=o[4],l=o[5],u=o[6],d=c.match(n);if(null===d)throw new Error("Could not parse line ".concat(t));if(s!==l)throw new Error("Delimeter mismatch on line ".concat(t));var h=d.map(function(e){return parseInt(e,10)});"/"===s&&(h=h.reverse());var m=h.map(function(e){return a.corners[e-1]}).map(function(e){return new v.Vector3(e[0],e[1],e[2])}),p=tt.tesselate(m);if(0===p.length)throw new Error("Could not tesselate line ".concat(t));for(var f=[],g=0,b=p.length;g<b;g+=3)f.push([p[g],p[g+1],p[g+2]]);this.model.surfaces.push({faces:f,material:u,vertices:h.map(function(e){return a.corners[e-1]})})}}}]),e}(),rt=function(){function e(){Object(c.a)(this,e),this.name="CATT Importer",this.readme=n.a.createElement("div",null,"Hello"),this.model={receivers:[],signature:"XAAT",sources:[],surfaces:[],version:3},this.materials=[]}return Object(l.a)(e,[{key:"add",value:function(e,t){if(console.log("catt importer add"),void 0===t)throw new Error("CATT File importer needs file names");var a=t.toLocaleLowerCase();if(a.endsWith(".geo")){var r=(new TextDecoder).decode(e),n=new at(r);console.log("new material",n),this.model.surfaces=n.model.surfaces,this.materials=n.materials}else{if(!a.endsWith(".loc"))throw new Error("Unexpected file extension in ".concat(a));this.consumeLoc(e)}}},{key:"consumeLoc",value:function(e){var t=(new TextDecoder).decode(e).split("\n").map(function(e){return e.trim()});console.log("consuming loc file",t);for(var a;void 0!==(a=t.shift());){0;var r=a.toLowerCase().trim();if(!r.startsWith(";"))if(console.log(r),"receivers"===r)this.consumeReceivers(t);else if(r.startsWith("source ")){var n=r.substr(6).trim();this.consumeSource(n,t)}}}},{key:"consumeReceivers",value:function(e){console.log("consume recv",e);for(var t,a=/(\d?[.,]?\d+)/g;void 0!==(t=e.shift());){var r=t.match(a);if(null===r||4!==r.length)return void e.unshift(t);var n=r.map(function(e){return parseFloat(e.replace(",","."))}),i=Object(Ze.a)(n),o=i[0],s=i.slice(1);this.model.receivers.push({name:"R".concat(Math.round(o)),position:s,attributes:{}})}}},{key:"consumeSource",value:function(e,t){console.log("consume source",t);for(var a,r=/(\d?[.,]?\d+)/g;void 0!==(a=t.shift());){var n=a.toLocaleLowerCase().trim();if("end"===n)return;if(n.startsWith("pos")){var i=a.match(r);if(null===i||3!==i.length)throw new Error('Error parsing source position "'.concat(a,'"'));var o=i.map(function(e){return parseFloat(e.replace(",","."))});this.model.sources.push({name:e,position:o})}}}}]),e}(),nt=function(){function e(t,a){Object(c.a)(this,e),this.dataView=t,this.littleEndian=a,this.o=0,this.textDecoder=new TextDecoder}return Object(l.a)(e,[{key:"getBuffer",value:function(e){var t=this.advance(e);return this.dataView.buffer.slice(t,t+e)}},{key:"getH16String",value:function(){return this.getString(this.getUInt16())}},{key:"getString",value:function(e){return 0===e?"":this.textDecoder.decode(this.getBuffer(e))}},{key:"getUInt16",value:function(){return this.dataView.getUint16(this.advance(2),this.littleEndian)}},{key:"getUInt32",value:function(){return this.dataView.getUint32(this.advance(4),this.littleEndian)}},{key:"getInt32",value:function(){return this.dataView.getInt32(this.advance(4),this.littleEndian)}},{key:"getFloat",value:function(){return this.dataView.getFloat32(this.advance(4),this.littleEndian)}},{key:"advance",value:function(e){var t=this.o;return this.o+=e,t}},{key:"eof",value:function(){return this.offset>=this.dataView.byteLength}},{key:"offset",get:function(){return this.o}}]),e}(),it=function e(t){Object(c.a)(this,e),this.name=void 0,this.description=void 0,this.absorptionOriginal=[],this.scatterOriginal=[],this.absorption=[],this.scatter=[];var a=new nt(new DataView(t),!0),r=a.getString(4);a.advance(6);var n=a.getString(2);if("EASE"!==r||"wm"!==n)throw new Error(".mat file signature is expected to have EASE and wm.");a.advance(10);var i=a.getUInt16();if(338===i){a.advance(6),this.name=a.getString(16).trim(),this.description=a.getString(36).trim(),a.advance(108);for(var o=0;o<21;o++)this.absorptionOriginal.push(Math.round((1e4-a.getUInt16())/100));for(var s=0;s<18;s+=3)this.absorption.push((this.absorptionOriginal[s]+this.absorptionOriginal[s+1]+this.absorptionOriginal[s+2])/3);this.scatterOriginal=[0,0,0,0,0,0],this.scatter=[0,0,0,0,0,0]}else{if(774!==i)throw new Error("Unknown material format version.");a.advance(6),this.name=a.getH16String(),this.description=a.getH16String(),a.advance(108);for(var l=0;l<21;l++)this.absorptionOriginal.push(Math.round((1e4-a.getUInt16())/100));for(var u=0;u<18;u+=3)this.absorption.push((this.absorptionOriginal[u]+this.absorptionOriginal[u+1]+this.absorptionOriginal[u+2])/3);a.advance(2);for(var d=0;d<21;d++)this.scatterOriginal.push(Math.round(a.getUInt16()/100));for(var h=0;h<18;h+=3)this.scatter.push((this.scatterOriginal[h]+this.scatterOriginal[h+1]+this.scatterOriginal[h+2])/3)}},ot=function e(t){Object(c.a)(this,e),this.faces=[];var a=new nt(new DataView(t),!0),r=a.getString(4);a.advance(6);var n=a.getString(2);if("EASE"!==r||"fc"!==n)throw new Error("Signature error.");a.advance(6);var i=a.getUInt32();a.advance(30);var o=a.getUInt16();a.advance(o+6);var s=a.getUInt16();a.advance(s+218);for(var l=0;l<i;l++){var u=a.getH16String();a.advance(6);var d=a.getH16String();a.advance(6);var h=a.getH16String();a.advance(4);var m=a.getH16String();a.advance(8);var p=a.getUInt32();a.advance(8);var f=a.getUInt32();a.advance(14);for(var v=[],g=0;g<f;g++)v.push(a.getInt32());a.advance(150),this.faces.push({color:p,frontMaterial:u,id:l+1,rearMaterial:d,textureFront:h,textureRear:m,vertices:v})}},st=function e(t){Object(c.a)(this,e),this.speakears=[],this.default=void 0;var a=new nt(new DataView(t),!0),r=a.getString(4);a.advance(6);var n=a.getString(2);if("EASE"!==r||"ld"!==n)throw new Error("Signature error.");a.advance(6);var i=a.getUInt32();a.advance(8);for(var o=0;o<i+1;o++){var s=a.getH16String(),l=a.getH16String();a.advance(8);var u=[a.getFloat(),a.getFloat(),a.getFloat()];a.advance(12);var d=a.getH16String();a.advance(4);var h=a.getH16String(),m=a.getH16String(),p=[];a.getFloat();for(var f=0;f<21;f++)p.push(a.getFloat());a.getFloat();for(var v=[],g=0;g<21;g++)v.push(a.getFloat());this.speakears.push({elePower:p,group:h,model:d,name:s,image:l,imageGroup:m,position:u,spl:v}),a.advance(184),1===a.getUInt16()&&a.advance(60),a.advance(128)}this.default=this.speakears.shift()},ct=function e(t){Object(c.a)(this,e),this.seats=[],this.firstSeat=void 0;var a=new nt(new DataView(t),!0),r=a.getString(4);a.advance(6);var n=a.getString(2);if("EASE"!==r||"st"!==n)throw new Error("Signature error.");a.advance(6);var i=a.getUInt32();a.advance(8);for(var o=0;o<i+1;o++){var s=a.getH16String(),l=a.getH16String();a.advance(8);var u=[a.getFloat(),a.getFloat(),a.getFloat()];a.advance(12);a.getH16String(),a.getH16String();var d={mirror:l,name:s,position:u};0===o?this.firstSeat=d:this.seats.push(d),a.advance(256)}},lt=function e(t){Object(c.a)(this,e),this.vertices=[];var a=new nt(new DataView(t),!0),r=a.getString(4);a.advance(6);var n=a.getString(2);if("EASE"!==r||"vt"!==n)throw new Error("Signature error");a.advance(6);var i=a.getUInt32();a.advance(60);for(var o=0;o<i;o++)this.vertices.push([a.getFloat(),a.getFloat(),a.getFloat()]),a.advance(28)},ut=function e(t){Object(c.a)(this,e),this.files=[],this.materials=[],this.vertices=[],this.faces=[],this.seats=[],this.speakers=[],this.type=void 0;var a=new nt(new DataView(t),!0),r=a.getString(4);a.advance(26);var n=a.getString(4);if("EASE"!==r)throw new Error("Signature error");if(-1===e.KnownPackTypes.indexOf(n))throw new Error("Unknown pack type ".concat(n));for(this.type=n,a.advance(16);!a.eof();){var i=a.getUInt32();if(1314017096!==i&&1280065879!==i&&1112298818!==i&&1162887508!==i){var o=a.getString(i),s=a.getUInt32(),l=a.getBuffer(s);this.files.push({buffer:l,name:o,size:s})}else a.advance(16)}var u=this.files.filter(function(e){return e.name.toLocaleLowerCase().endsWith(".mat")});0!==u.length&&(this.materials=u.map(function(e){return new it(e.buffer)}));var d=this.files.filter(function(e){return e.name.toLocaleLowerCase().endsWith(".fvt")})[0];void 0!==d&&(this.vertices=new lt(d.buffer).vertices);var h=this.files.filter(function(e){return e.name.toLocaleLowerCase().endsWith(".ffc")})[0];void 0!==h&&(this.faces=new ot(h.buffer).faces);var m=this.files.filter(function(e){return e.name.toLocaleLowerCase().endsWith(".fst")})[0];void 0!==m&&(this.seats=new ct(m.buffer).seats);var p=this.files.filter(function(e){return e.name.toLocaleLowerCase().endsWith(".fld")})[0];void 0!==p&&(this.speakers=new st(p.buffer).speakears)};ut.KnownPackTypes=["ROOM","WALL"];var dt=function e(t){Object(c.a)(this,e),this.surfaces=[];for(var a,r=t.split("\n").map(function(e){return e.trim()}),n=0;a=r.shift();)if(n++,!a.startsWith(";")&&a.startsWith('"Material"')){for(var i=a.split(",").map(function(e){return e.slice(1,-1)}),o=Object($e.a)(i,2),s=(o[0],o[1]),l=[],u=[];'"End"'!==(a=r.shift());){if(n++,void 0===a)throw new Error("Premature end of file while in material block");var d=a.split(",").map(function(e){return parseFloat(e)});if(3!==d.length)throw new Error("A vertice lice should contain 3 floats at line ".concat(n,": ").concat(a));u.push(d[0],d[1],d[2]),l.push(new v.Vector3(d[0],d[1],d[2]))}console.log("Tesselating ".concat(n,": ").concat(s));var h=tt.tesselate(l);if(h.length>0){for(var m=[],p=0,f=h.length;p<f;p+=3)m.push([h[p],h[p+1],h[p+2]]);this.surfaces.push({faces:m,material:s,vertices:l.map(function(e){return[e.x,e.y,e.z]})})}else console.log("Could not tesselate ".concat(n,": ").concat(a))}},ht=function e(t){Object(c.a)(this,e),this.sources=[];for(var a,r=t.split("\n").map(function(e){return e.trim()});a=r.shift();)if(0,!a.startsWith(";")&&a.startsWith('"Label"')){if(r.length<7)throw new Error("Premature end of file while in speaker block");var n=a.split(",").map(function(e){return e.slice(1,-1)}),i=Object($e.a)(n,2)[1],o=r.shift(),s=r.shift(),l=(r.shift(),r.shift(),r.shift(),r.shift(),r.shift(),o.split(",").map(function(e){return parseFloat(e)})),u=Object($e.a)(l,4),d=u[1],h=u[2],m=u[3],p=s.split(","),f=Object($e.a)(p,4);f[1],f[2],f[3];this.sources.push({name:i,position:[d,h,m]})}},mt=function e(t){Object(c.a)(this,e),this.receivers=[];for(var a,r=t.split("\n").map(function(e){return e.trim()});a=r.shift();)if(0,!a.startsWith(";")&&a.startsWith('"Label"')){if(r.length<2)throw new Error("Premature end of file while in label block");var n=a.split(",").map(function(e){return e.slice(1,-1)}),i=Object($e.a)(n,2)[1],o=r.shift(),s=r.shift(),l=o.split(",").map(function(e){return parseFloat(e)}),u=Object($e.a)(l,4),d=u[1],h=u[2],m=u[3],p=s.split(","),f=Object($e.a)(p,4),v=f[1],g=f[2],b=f[3];this.receivers.push({attributes:{hor:g,rot:b,ver:v},name:i,position:[d,h,m]})}},pt=function(){function e(){Object(c.a)(this,e),this.name="EASE Files Importer",this.readme=n.a.createElement("div",null,"Hello"),this.model={receivers:[],signature:"XAAT",sources:[],surfaces:[],version:3},this.materials=[]}return Object(l.a)(e,[{key:"add",value:function(e,t){var a=this;try{if(void 0===t)throw new Error("EASE File importer needs file names");var r=t.toLocaleLowerCase();if(r.endsWith(".mat")){var n=new it(e);return console.log("new material",n,this),this.materials.push({absorption:S(n.absorption),defaultValues:!1,name:n.name,scatter:S(n.scatter)}),Promise.resolve(this)}if(r.endsWith(".xfc")){var i=(new TextDecoder).decode(e),o=new dt(i);return this.model.surfaces=o.surfaces,Promise.resolve(this)}if(r.endsWith(".xst")){var s=(new TextDecoder).decode(e),c=new mt(s);return this.model.receivers=c.receivers,Promise.resolve(this)}if(r.endsWith(".xld")){var l=(new TextDecoder).decode(e),u=new ht(l);return this.model.sources=u.sources,Promise.resolve(this)}if(r.endsWith("_pwm.zip"))return(new ve.a).loadAsync(e).then(function(e){var r=Object.keys(e.files).find(function(e){return e.toLocaleLowerCase().endsWith(".pwm")});if(void 0===r)throw new Error("EASEFilesImporter: ZIP file does not contain a PWM file ".concat(t));return e.file(r).async("arraybuffer").then(function(e){var t=new ut(e);return console.log("UNpacked materials",t.materials),a.materials=t.materials.map(function(e){return{absorption:S(e.absorption),defaultValues:!1,name:e.name,scatter:S(e.scatter)}}),a})});throw new Error("Unexpected file extension in ".concat(r))}catch(d){return Promise.reject(d)}}}]),e}(),ft=function(){function e(){Object(c.a)(this,e),this.model={receivers:[],signature:"XAAT",sources:[],surfaces:[],version:3},this.name="EASE Pack Importer",this.materials=[],this.readme=n.a.createElement("div",null,n.a.createElement(de.a,{title:"Notes",intent:"primary"},"Ignores source and receiver directivity"))}return Object(l.a)(e,[{key:"add",value:function(e,t){for(var a=this,r=new ut(e),n=0,i=r.speakers.length;n<i;n++){var o=r.speakers[n];this.model.sources.push({name:o.name,position:o.position})}for(var s=0,c=r.seats.length;s<c;s++){var l=r.seats[s];this.model.receivers.push({attributes:{},name:l.name,position:l.position})}for(var u=0,d=r.materials.length;u<d;u++){var h=r.materials[u];this.materials.push({absorption:S(h.absorption),name:h.name,scatter:S(h.scatter),defaultValues:!1})}this.model.surfaces=r.faces.map(function(e,t){var n=[];try{n=a.convert(r.vertices,e.vertices)}catch(u){console.log("Problem with face",e)}var i=n.map(function(e){return new v.Vector3(e[0],e[1],e[2])}),o=tt.tesselate(i);63===t&&console.log(i,o);for(var s=[],c=0,l=o.length;c<l;c+=3)s.push([o[c],o[c+1],o[c+2]]);return{faces:s,material:e.frontMaterial,vertices:n}})}},{key:"convert",value:function(e,t){return t.map(function(t){var a=t<0;t=Math.abs(t);var r=e[t-1];return a&&(r[0]=-r[0]),r})}}]),e}(),vt=(a(360),ce.a.TOOLTIP_INDICATOR,function(e){function t(e){var a;if(Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).easePackImporter=void 0,a.easeFilesImporter=void 0,a.cattImporter=void 0,a.dragDepth=0,a.import=function(e){for(var t=[],r=[],n=[],i=[],o=0,s=e.length;o<s;o++){var c=e.item(o);if(null!==c&&!(c.size>10485760)){var l=c.name.toLocaleLowerCase();l.endsWith("_pwm.zip")?t.push(c):l.endsWith(".zip")||l.endsWith(".ppj")?r.push(c):l.endsWith(".xfc")||l.endsWith(".xld")||l.endsWith(".xst")||l.endsWith(".pwm")||l.endsWith(".mat")?t.push(c):l.endsWith(".geo")||l.endsWith(".loc")?n.push(c):(l.endsWith(".json")||l.endsWith(".xea"))&&i.push(c)}}try{if(1===e.length&&1===r.length){var u=r[0];a.easePackImporter=new ft,Ke.readArrayBuffer(u).then(function(e){u.name.toLocaleLowerCase().endsWith(".zip")?(new ve.a).loadAsync(e).then(function(e){var t=Object.keys(e.files).filter(function(e){return e.toLocaleLowerCase().endsWith(".ppj")});if(0===t.length)throw new Error("".concat(u," does not contain a ppj file"));return e.file(t[0]).async("arraybuffer")}).then(function(e){a.easePackImporter.add(e)}).then(function(){a.setState({activeImporter:a.easePackImporter},a.validate)}):(a.easePackImporter.add(e),a.setState({activeImporter:a.easePackImporter},a.validate))})}else if(t.length>0)for(var d=function(e,r){var n=t[e];Ke.readArrayBuffer(n).then(function(e){return a.easeFilesImporter.add(e,n.name)}).then(function(){a.setState({activeImporter:a.easeFilesImporter},a.validate)})},h=0,m=t.length;h<m;h++)d(h);else if(n.length>0)for(var p=function(e,t){var r=n[e];Ke.readArrayBuffer(r).then(function(e){return a.cattImporter.add(e,r.name)}).then(function(){a.setState({activeImporter:a.cattImporter},a.validate)})},f=0,v=n.length;f<v;f++)p(f);else i.length}catch(g){console.log("parse error")}},a.dragEnter=function(e){a.dragDepth++,e.preventDefault(),e.stopPropagation(),a.showDropGuide()},a.dragOver=function(e){e.preventDefault(),e.stopPropagation()},a.dragLeave=function(e){a.dragDepth--,e.preventDefault(),e.stopPropagation(),0===a.dragDepth&&a.hideDropGuide()},a.drop=function(e){e.preventDefault(),e.stopPropagation(),null!==e.dataTransfer?a.import(e.dataTransfer.files):a.hideDropGuide()},a.validate=function(){if(null!==a.state.activeImporter){var e=Object.keys(j.getInstance().materials),t=a.state.activeImporter.materials.map(function(e){return e.name}),r=e.concat(t).filter(R),n=a.state.activeImporter.model.surfaces.filter(function(e){return-1===r.indexOf(e.material)}).map(function(e){return e.material}).filter(R);a.setState({missingMaterials:n}),a.forceUpdate()}},a.importClicked=function(){null!==a.state.activeImporter&&(a.state.activeImporter.materials.forEach(function(e){j.getInstance().addMaterial(e.name,e.absorption,e.scatter)}),a.state.activeImporter.model.surfaces.length>0&&a.props.view.loadModel(a.state.activeImporter.model),a.hideDropGuide())},a.showDropGuide=function(){a.setState({showDropGuide:!0})},a.hideDropGuide=function(){a.setState({showDropGuide:!1}),a.initImporters()},a.initImporters=function(){a.easePackImporter=new ft,a.easeFilesImporter=new pt,a.cattImporter=new rt},void 0!==t.instance)throw new Error("Import component should be created only once");return t.instance=Object(m.a)(Object(m.a)(a)),a.state={activeImporter:null,showDropGuide:!1,missingMaterials:[]},a.initImporters(),a}return Object(h.a)(t,e),Object(l.a)(t,null,[{key:"import",value:function(e){if(void 0===t.instance)throw new Error("Import component is not initiated");t.instance.import(e),t.instance.setState({showDropGuide:!0})}}]),Object(l.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("dragenter",this.dragEnter,!1),document.addEventListener("dragleave",this.dragLeave,!1),document.addEventListener("drop",this.drop,!1),document.addEventListener("dragover",this.dragOver,!1)}},{key:"render",value:function(){var e=this.props,t=(e.view,Object(se.a)(e,["view"]));return n.a.createElement(le.a,Object.assign({isOpen:this.state.showDropGuide,onClose:this.hideDropGuide,className:"xen-drop-guide",portalClassName:"bp3-dark",canOutsideClickClose:!0,canEscapeKeyClose:!0},t),this.state.activeImporter&&n.a.createElement(ue.a,{className:"xen-import-review",style:{width:"80%",maxWidth:"500px"}},n.a.createElement("h2",null,this.state.activeImporter.name),(0===this.state.activeImporter.model.sources.length||0===this.state.activeImporter.model.receivers.length)&&n.a.createElement(de.a,{intent:"warning",title:"Missing source/receiver"},"Geometric Analysis will be disabled.",n.a.createElement("br",null),"You can drag/drop additional files (.xld, .xst for EASE, .loc files for CATT)."),0!==this.state.missingMaterials.length&&n.a.createElement(de.a,{intent:"warning",title:"Missing materials"},"There are ",this.state.missingMaterials.length,"\xa0",n.a.createElement(he.a,{className:ce.a.TOOLTIP_INDICATOR,content:n.a.createElement("div",null,this.state.missingMaterials.map(function(e){return n.a.createElement("div",null,e)}))},"surface(s)")," that lacks materials. These materials will be created with default values but analysis will not be allowed until these values are edited."),n.a.createElement("table",{className:"bp3-html-table bp3-html-table-condensed bp3-html-table-striped"},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("td",null),n.a.createElement("td",null,"Item"),n.a.createElement("td",null,"Count"),n.a.createElement("td",null,"Status"))),n.a.createElement("tbody",null,n.a.createElement("tr",null,n.a.createElement("td",null,n.a.createElement(ze,{height:16})),n.a.createElement("td",null,"Sources"),n.a.createElement("td",null,this.state.activeImporter.model.sources.length),n.a.createElement("td",null,this.state.activeImporter.model.sources.length>0&&n.a.createElement(me.a,{icon:"tick-circle",intent:"success"}),0===this.state.activeImporter.model.sources.length&&n.a.createElement(me.a,{icon:"warning-sign",color:"yellow"}))),n.a.createElement("tr",null,n.a.createElement("td",null,n.a.createElement(Ae,{height:16})),n.a.createElement("td",null,"Receivers"),n.a.createElement("td",null,this.state.activeImporter.model.receivers.length),n.a.createElement("td",null,this.state.activeImporter.model.receivers.length>0&&n.a.createElement(me.a,{icon:"tick-circle",intent:"success"}),0===this.state.activeImporter.model.receivers.length&&n.a.createElement(me.a,{icon:"warning-sign",color:"yellow"}))),n.a.createElement("tr",null,n.a.createElement("td",null,n.a.createElement(Ye,{height:16})),n.a.createElement("td",null,"Surfaces"),n.a.createElement("td",null,this.state.activeImporter.model.surfaces.length),n.a.createElement("td",null,this.state.activeImporter.model.surfaces.length>0&&n.a.createElement(me.a,{icon:"tick-circle",intent:"success"}),0===this.state.activeImporter.model.surfaces.length&&n.a.createElement(me.a,{icon:"error",intent:"danger"}))),n.a.createElement("tr",null,n.a.createElement("td",null,n.a.createElement("span",{className:"bp3-icon"},n.a.createElement(Me,{height:16}))),n.a.createElement("td",null,"Materials"),n.a.createElement("td",null,this.state.activeImporter.materials.length),n.a.createElement("td",null,0===this.state.missingMaterials.length&&n.a.createElement(me.a,{icon:"tick-circle",intent:"success"}),0!==this.state.missingMaterials.length&&n.a.createElement(me.a,{icon:"warning-sign",intent:"warning"}))))),n.a.createElement("div",{style:{padding:"10px",marginTop:"10px",display:"flex",justifyContent:"space-around"}},n.a.createElement(pe.b,{icon:"import",className:"xen-import-button",intent:"primary",onClick:this.importClicked},"Import"))),!this.state.activeImporter&&n.a.createElement(ue.a,null,n.a.createElement("div",{className:""},n.a.createElement("div",{className:"xen-drop-box"},n.a.createElement("div",null,n.a.createElement(me.a,{icon:"import",iconSize:64})),n.a.createElement("div",null,"Please drop a supported file.",n.a.createElement("br",null),n.a.createElement("br",null),"CATT files (.geo, .loc)",n.a.createElement("br",null),"EASE packs (.zip)",n.a.createElement("br",null),"EASE exports (.xst, .xld, .xfc, .mat, .pwm)",n.a.createElement("br",null),"SketchUp exports via extension (.json)",n.a.createElement("br",null),"See Notes.")))))}}]),t}(n.a.PureComponent));vt.instance=void 0;var gt=a(252),bt=a(77),yt=a(263),wt=a.n(yt),Et=function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,null,[{key:"SharedArrayBuffer",get:function(){return"function"===typeof window.SharedArrayBuffer}},{key:"ClipboardAPI",get:function(){return navigator.clipboard&&"function"===typeof navigator.clipboard.readText}}]),e}(),Ot=a(269),St=(a(366),function(e){function t(e){var a;Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).bringForward=function(){a.setState({zIndex:t.zIndexCounter++})},a.bringBack=function(){},a.updateGeometry=function(e){a.setState(e,function(){a.storeGeometry()})},a.ignoreOnce=!1,a.onContentResize=function(e,t){},a.closeHandler=function(){void 0!==a.props.onClose&&a.props.onClose()},a.toggleMinimize=function(){a.setState(function(e,t){return{minimized:!e.minimized}})},a.dragHandler=function(e,t){a.updateGeometry({x:t.x,y:t.y})},a.resizeHandler=function(e,t,r,n,i){a.updateGeometry({height:a.state.height+n.height,width:a.state.width+n.width})},a.mouseDown=function(e){a.bringForward()};var r=e.width||400,n=e.height||200;return a.state={zIndex:t.zIndexCounter++,height:n,minimized:!1,top:!1,width:r,x:void 0!==a.props.x?a.props.x:(window.innerWidth-r)/2,y:void 0!==a.props.y?a.props.y:(window.innerHeight-n)/2},a.recallGeometry(),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.name,a=e.hideTitleBar,r=e.className,i=Object(se.a)(e,["name","hideTitleBar","className"]),o="window-draggable";return void 0!==r&&(o+=" "+r),this.state.minimized&&(o+=" window-minimized"),n.a.createElement(Ot.a,Object.assign({onMouseDown:this.mouseDown},i,{style:{zIndex:this.state.zIndex},className:o,minWidth:this.props.minWidth||100,key:this.props.name,position:{x:this.state.x,y:this.state.y},size:{width:this.state.width,height:this.state.height},onDragStop:this.dragHandler,onResizeStop:this.resizeHandler}),n.a.createElement("div",{className:"bp3-dialog-container bp3-dark ea-compact",style:{alignItems:"inherit"}},n.a.createElement("div",{className:"bp3-dialog",style:{margin:0,width:"100%"}},void 0===a||!1===a?n.a.createElement("div",{className:"bp3-dialog-header window-handle"},n.a.createElement("span",{className:this.getIcon()}),n.a.createElement("h6",{className:"bp3-heading"},t),n.a.createElement(pe.b,{"aria-label":"Minimize-Maximize",onClick:this.toggleMinimize,icon:this.state.minimized?"maximize":"minimize",minimal:!0}),this.props.onClose&&n.a.createElement("button",{"aria-label":"Close",onClick:this.closeHandler,className:"bp3-dialog-close-button bp3-button bp3-minimal bp3-icon-cross"})):"",n.a.createElement("div",{style:{overflow:"auto"}},this.props.children))))}},{key:"getIcon",value:function(){var e="bp3-icon-small ";return void 0!==this.props.icon?e+=this.props.icon:e+="bp3-icon-drag-handle-horizontal",e}},{key:"recallGeometry",value:function(){var e=localStorage.getItem("WindowPositions")||"{}",t=JSON.parse(e);void 0===t[this.props.name]&&(t[this.props.name]={height:this.state.height,width:this.state.width,x:this.state.x,y:this.state.y});var a=t[this.props.name];a.x=a.x.clamp(0,window.innerWidth-a.width),a.y=a.y.clamp(0,window.innerHeight-a.height),Object.assign(this.state,t[this.props.name])}},{key:"storeGeometry",value:function(){var e=localStorage.getItem("WindowPositions")||"{}",t=JSON.parse(e);t[this.props.name]={height:this.state.height,width:this.state.width,x:this.state.x,y:this.state.y},localStorage.setItem("WindowPositions",JSON.stringify(t))}}]),t}(n.a.Component));St.zIndexCounter=0;var kt=function(e){function t(e){return Object(c.a)(this,t),Object(u.a)(this,Object(d.a)(t).call(this,e))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.a.createElement(St,Object.assign({name:"About"},this.props),n.a.createElement("div",{className:"bp3-dialog-body"},"lorem"))}}]),t}(n.a.PureComponent),jt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).fileSelected=function(e){null!==e.currentTarget&&null!==e.currentTarget.files&&(vt.import(e.currentTarget.files),a.props.onClose&&a.props.onClose())},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.a.createElement(St,Object.assign({name:"FileUpload",enableResizing:{}},this.props),n.a.createElement("div",{className:"bp3-dialog-body"},n.a.createElement("input",{type:"file",multiple:!0,accept:".zip,.xfc,.xst,.xld,.pwm,.ppj,.geo,.loc,.xea,.json",onChange:this.fileSelected}),n.a.createElement("br",null),"Try drag and dropping various file formats into this app. Launching browser's file browse dialog is not implemented yet."))}}]),t}(n.a.PureComponent),xt=a(253),Mt=a(256),Ct=a(195),It=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={isOpen:!1},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement(pe.b,{onClick:function(){return e.setState({isOpen:!e.state.isOpen})},rightIcon:this.state.isOpen?"caret-down":"caret-right",minimal:!0,text:this.props.text}),n.a.createElement(Ct.a,{isOpen:this.state.isOpen},this.props.children))}}]),t}(n.a.PureComponent),Dt=(a(367),a(264)),Rt=a.n(Dt),Lt=a(255),Pt=a(94),At=(a(369),a(370),a(371),a(80)),Ft=a.n(At),Vt=(a(380),a(453),a(462),a(474),a(242),a(17)),Nt=a.n(Vt),Tt=a(265),Bt=a.n(Tt),Wt=a(81),Ut=a(514),zt=Ut.a.ofType(),Gt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).itemRenderer=function(e,t){return n.a.createElement(oe.a,{active:t.modifiers.active,disabled:t.modifiers.disabled,key:e,text:e,onClick:t.handleClick})},a.itemSelect=function(e){a.setState({activeOption:e}),a.props.onSelect(e)},a.state={activeOption:a.props.options[0]},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.a.createElement(zt,{items:this.props.options,activeItem:this.state.activeOption,filterable:!1,itemRenderer:this.itemRenderer,onItemSelect:this.itemSelect},n.a.createElement(pe.b,{text:this.state.activeOption,rightIcon:"double-caret-vertical"}))}}]),t}(n.a.PureComponent);a(251);Nt.a.registerTheme("dark",Wt);var Ht=function(e){function t(e){return Object(c.a)(this,t),Object(u.a)(this,Object(d.a)(t).call(this,e))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.a.createElement(Ft.a,{echarts:Nt.a,option:this.getOptions(),theme:"dark",opts:{renderer:"svg"},style:{width:"100%",height:"250px"}})}},{key:"getOptions",value:function(){return{title:{text:"RT"},tooltip:{trigger:"axis"},grid:{bottom:"3%",containLabel:!0,left:"3%",right:"4%"},toolbox:{feature:{saveAsImage:{}}},xAxis:{type:"category",boundaryGap:!1,data:["125 Hz","250 Hz","500 Hz","1 kHz","2 kHz","4 kHz"]},yAxis:{type:"value"},series:[{data:this.props.rt,name:"before",type:"line"}]}}}]),t}(n.a.PureComponent);Nt.a.registerTheme("dark",Wt);var _t=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={options:qt,activeBand:E[0]},a.rt=[],a.bandChanged=function(e){a.setState({activeBand:parseInt(e)}),a.forceUpdate()},console.log("RView init",e),E.forEach(function(e){var t=a.t30(e).t30;a.rt.push(t)}),console.log("rt",a.rt),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"getOptions",value:function(){var e=this,t=this.createOptionsTemplate();console.log(this.props.data);var a=this.props.data.filter(function(t){return t[2]===e.state.activeBand});t.series=[],t.series.push({barWidth:2,data:a,name:"Reflectogram",type:"bar"}),console.log("option series len",t.series.length);var r=this.t30(this.state.activeBand),n=(r.t30,r.logSchroeder),i=r.atZero,o=r.atSix;return t.series.push({data:n,name:"Schroeder",sampling:"average",type:"line"}),t.series.push({data:[[0,i],[6,o]],name:"Linear Regression",type:"line"}),t.series[0].data=t.series[0].data.map(function(e){return[e[0],D.P22dbSPL(e[1])]}),t}},{key:"render",value:function(){return console.log("RV render"),n.a.createElement(St,Object.assign({name:"Reflectogram Viewer",maxWidth:600,height:400,dragHandleClassName:"bp3-dialog-header",width:600},this.props),n.a.createElement(bt.a,{style:{minWidth:200}},n.a.createElement(pe.b,{icon:"floppy-disk",title:"Save"}),n.a.createElement(pe.b,{icon:"folder-open",title:"load"}),n.a.createElement(pe.b,{icon:"timeline-area-chart",title:"Schroeder"}),n.a.createElement(Gt,{options:E.map(function(e){return e.toString()}),onSelect:this.bandChanged})),n.a.createElement(Lt.a,{animate:!1},n.a.createElement(Pt.a,{id:"reflectogram",title:"Reflectogram",panel:n.a.createElement(Ft.a,{echarts:Nt.a,option:this.getOptions(),theme:"dark",style:{width:"100%",minHeight:"250px"}})}),n.a.createElement(Pt.a,{id:"t30",title:"T30",panel:n.a.createElement(Ht,{rt:this.rt})})))}},{key:"t30",value:function(e){var t=this.props.data.filter(function(t){return t[2]===e}),a=t.length,r=new Array(a);r[a-1]=[t[a-1][0],t[a-1][1]];for(var n=a-2;n>=0;n--)r[n]=[t[n][0],r[n+1][1]+t[n][1]];var i=r.map(function(e){return[e[0],10*Math.log10(e[1])]}),o=i[0][1],s=i.filter(function(e){return e[1]<o-5&&e[1]>o-35}),c=Bt.a.linear(s).equation,l=Object($e.a)(c,2),u=l[0],d=l[1];console.log("lg",u,d);var h=(d-60-d)/u;return{t30:h,logSchroeder:i,atZero:d,atSix:6*u+d}}},{key:"createOptionsTemplate",value:function(){return Object.assign({},qt)}}]),t}(n.a.PureComponent),qt={dataZoom:[{type:"inside"},{type:"slider"}],grid:{bottom:50},legend:{show:!0},series:[],tooltip:{axisPointer:{type:"shadow"},trigger:"axis"},xAxis:{silent:!1,splitArea:{show:!1},splitLine:{show:!1}},yAxis:{splitArea:{show:!1},max:100}},Jt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).reflectogramId=0,a.openReflectogram=function(e){a.setState(function(t){return{openedReflectograms:[{key:a.reflectogramId++,name:e}].concat(t.openedReflectograms)}})},a.closeReflectogram=function(e){console.log("Closing",e),a.setState(function(t){return{openedReflectograms:t.openedReflectograms.filter(function(t){return t.key!==e})}})},a.state={openedReflectograms:[]},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.simulationStats,r=Object(se.a)(t,["simulationStats"]),i=a;if(void 0===i)return[];for(var o=i.model,s=i.rays,c=0,l=0,u=s.length;l<u;l++){var d=s[l];c+=new T(d).meanFreePath()}var h=c/s.length;return console.log("mfp",h),[n.a.createElement(St,Object.assign({key:"dafaq",height:500},r),n.a.createElement("div",{className:"bp3-dialog-body"},n.a.createElement("table",{className:"bp3-html-table bp3-html-table-bordered bp3-html-table-condensed bp3-html-table-striped bp3-small"},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",null,"Metric"),n.a.createElement("th",null,"Value"))),n.a.createElement("tbody",null,n.a.createElement("tr",null,n.a.createElement("td",null,"Number of rays:"),n.a.createElement("td",null,i.rays.length)),n.a.createElement("tr",null,n.a.createElement("td",null,"Surfaces"),n.a.createElement("td",null,o.surfaces.length)),n.a.createElement("tr",null,n.a.createElement("td",null,"Faces"),n.a.createElement("td",null,o.surfaces.reduce(function(e,t){return e+t.faces.length},0))),n.a.createElement("tr",null,n.a.createElement("td",null,"Mean free path"),n.a.createElement("td",null,h)),n.a.createElement("tr",null,n.a.createElement("td",null,"Receivers"),n.a.createElement("td",null,o.receivers.length)),n.a.createElement("tr",null,n.a.createElement("td",null,"Sources"),n.a.createElement("td",null,o.sources.length)),n.a.createElement("tr",null,n.a.createElement("td",null,"Order"),n.a.createElement("td",null,i.iterations,n.a.createElement("span",{className:"bp3-text-small bp3-text-muted"},"(",Math.round(i.iterations/i.elapsed*1e3)," iteration/sec)"))),n.a.createElement("tr",null,n.a.createElement("td",null,"Time it took:"),n.a.createElement("td",null,(i.elapsed/1e3).toFixed(2),"s")),n.a.createElement("tr",null,n.a.createElement("td",null,"Reflectograms:"),n.a.createElement("td",null,Rt.a.pairs(i.receiverStats).map(function(t){return n.a.createElement("button",{key:t[0],onClick:function(){return e.openReflectogram(t[0])}},t[0]," (",t[1],")")}))))))),this.reflectograms()]}},{key:"reflectograms",value:function(){var e=this,t=this.props.simulationStats.reflectogramAggregator;return this.state.openedReflectograms.map(function(a){var r=t.generate(a.name,function(e){return[e.distance/343,e.p2,e.frequency]}).sort(function(e,t){return e[0]-t[0]});return n.a.createElement(_t,{key:a.key,name:a.name,data:r,onClose:function(){return e.closeReflectogram(a.key)}})})}}]),t}(n.a.PureComponent),Xt=function(){function e(t,a,r){var n=this;Object(c.a)(this,e),this.rays=t,this.reflectogramAggregator=a,this.model=r,this.iterations=0,this.receiverStats={},this.elapsed=-1,this.timeStart=0,this.timeEnd=0,a.receiversNames.forEach(function(e){return n.receiverStats[e]=0})}return Object(l.a)(e,[{key:"update",value:function(e){var t=this;this.iterations++;for(var a=function(a,r){var n=e[a];Object.keys(n).forEach(function(e){t.receiverStats[e]+=n[e]})},r=0,n=e.length;r<n;r++)a(r)}},{key:"start",value:function(){this.timeStart=performance.now()}},{key:"stop",value:function(){this.timeEnd=performance.now(),this.elapsed=this.timeEnd-this.timeStart}}]),e}(),Yt=function(e){function t(e){var a;Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).cancelSimulation=!1,a.jobId=-1,a.simulationStats=void 0,a.raysSAB=[],a.rays=[],a.rayGroup=new v.Group,a.rayGeometries=[],a.excite=function(){if(void 0===a.props.tracerMaster.model)return Promise.reject("Model not loaded");var e=a.props.jobs.addJob({name:"Exciting the space",progress:0,total:1});return a.props.tracerMaster.syncMaterials(j.getInstance().serialize()).then(function(){for(var e=[],t=0;t<a.state.sourceEnable.length;t++){a.state.sourceEnable[t]&&e.push(a.props.model.sources[t].name)}return a.props.tracerMaster.excite(e,a.state.rays)}).then(function(t){a.initRays(t.rays),a.simulationStats=new Xt(t.rays,new H(t.reflectogramsPerThread),a.props.tracerMaster.model),a.props.jobs.removeJob(e)})},a.run=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=a.simulationStats;0===t&&(a.jobId=a.props.jobs.addJob({name:"test",id:-1,progress:0,total:e}),r.start());var n=a.props.jobs.getJob(a.jobId);return void 0!==n&&a.props.jobs.updateJob(a.jobId,{progress:t/n.total}),a.props.tracerMaster.iterate().then(function(n){a.setState({progress:t/e,dead:n.dead}),t+=1;for(var i=0,o=a.rayGeometries.length;i<o;i++){var s=a.rays[i],c=a.rayGeometries[i];if(c.setDrawRange(0,s.order+1),c.attributes.position.needsUpdate=!0,!s.alive&&s.order+1===t){var l=new v.SphereGeometry(.1),u=new v.MeshBasicMaterial({color:16724736}),d=new v.Mesh(l,u);d.position.fromArray(s.vertices,4*s.order),a.rayGroup.add(d)}}if(r.update(n.hitsDiffsPerThread),n.dead!==a.state.rays&&t<e&&!a.cancelSimulation)return a.run(e,t);for(var h=a.raysSAB,m=0,p=0,f=h.length;p<f;p++){var g=h[p],b=new V(g);if(b.causeOfDeath===L.Leaked){m++;var y=b.origin,w=y.clone().add(b.direction.multiplyScalar(1e3)),E=new v.Geometry;E.vertices.push(y),E.vertices.push(w);var O=new v.Line(E);a.rayGroup.add(O)}}return console.log("total leaks",m),r.stop(),a.setState({showResults:!0,simulationStats:r,pauseDisabled:!0,playDisabled:!1,stopDisabled:!1,progress:0}),a.props.jobs.removeJob(a.jobId),n})},a.play=function(){a.setState({playDisabled:!0,stopDisabled:!1,progress:0,dead:0}),a.cancelSimulation=!1,a.excite().then(function(){return a.run(1e3)})},a.stop=function(){a.setState({playDisabled:!1,stopDisabled:!0}),a.cancelSimulation=!0,a.props.jobs.removeJob(a.jobId),a.jobId=-1},a.closeHandler=function(){a.setState({showResults:!1})},a.raysChanged=function(e,t){a.setState({rays:e})};var r=new Array(a.props.model.sources.length);return r.fill(!1),r[0]=!0,a.state={pauseDisabled:!0,playDisabled:!1,progress:0,rays:1e4,result:null,showResults:!1,stopDisabled:!0,dead:0,sourceEnable:r},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentWillReceiveProps",value:function(e){JSON.stringify(this.props.model)!==JSON.stringify(e.model)&&this.rayGroup&&this.props.scene.remove(this.rayGroup)}},{key:"initRays",value:function(e){this.raysSAB=e,this.rays=[],this.rayGeometries=[],this.rayGroup&&this.props.scene.remove(this.rayGroup),this.rayGroup=new v.Group;for(var t=0;t<20;t++){var a=e[t],r=new v.BufferGeometry;this.rayGeometries.push(r);var n=new V(a);this.rays.push(n),r.addAttribute("position",new v.BufferAttribute(n.vertices,4)),r.setDrawRange(0,0);var i=new v.Line(r);this.rayGroup.add(i)}this.props.scene.add(this.rayGroup)}},{key:"render",value:function(){var e=this,t=this.props,a=(t.model,t.tracerMaster,t.scene,t.onIterationComplete,t.jobs,Object(se.a)(t,["model","tracerMaster","scene","onIterationComplete","jobs"]));return[n.a.createElement(St,Object.assign({key:"parent",name:"Geometrical Analysis",height:250,enableResizing:{},maxWidth:320,width:320,minWidth:250,cancel:".bp3-input",className:"simulation-controller"},a),n.a.createElement("div",{className:"bp3-dialog-body"},n.a.createElement(It,{text:"Sources"},this.props.model.sources.map(function(t,a){return n.a.createElement(gt.a,{key:t.name,checked:e.state.sourceEnable[a],inline:!0,onChange:function(t){var r=e.state.sourceEnable.concat();r[a]=t.currentTarget.checked,e.setState({sourceEnable:r})}},t.name)})),n.a.createElement(xt.a,{inline:!0,labelFor:"number-of-rays",label:"Number of rays"},n.a.createElement(bt.a,null,n.a.createElement(Mt.a,{min:12,max:1e6,stepSize:1e4,majorStepSize:2e4,minorStepSize:1e3,value:this.state.rays,selectAllOnFocus:!0,clampValueOnBlur:!0,onValueChange:this.raysChanged}),n.a.createElement(pe.b,{disabled:this.state.playDisabled,icon:"play",onClick:this.play,title:"Play"}),n.a.createElement(pe.b,{disabled:this.state.stopDisabled,icon:"stop",onClick:this.stop,title:"Stop"}))),n.a.createElement(It,{text:"Advanced options"},n.a.createElement("div",{style:{padding:5}},n.a.createElement(pe.b,null,"Maximum order"),n.a.createElement(pe.b,null,"Show rays of band"),n.a.createElement(pe.b,null,"Show this many rays"))),n.a.createElement(te.a,{animate:!1,stripes:!1,value:this.state.progress}),"Alive rays: ",this.state.rays-this.state.dead)),this.results()]}},{key:"results",value:function(){return this.state.showResults?n.a.createElement(Jt,{name:"Simulation Results",simulationStats:this.state.simulationStats,onClose:this.closeHandler,isOpen:this.state.showResults}):[]}}]),t}(n.a.PureComponent),Kt=a(120),Zt=a(121),$t=a(266),Qt=a.n($t),ea=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).ref=null,a.urlChange=function(e){a.setState({url:e.target.value})},a.error=function(e){a.setState({error:e})},a.import=function(){a.state.url?(a.setState({showProgress:!0}),Qt()(a.state.url).then(function(e){if(console.log(e),!1===e.ok)throw new Error("test");return e.text()}).then(function(e){var t=JSON.parse(e);console.log(t),a.props.onLoad(t)}).catch(function(e){a.error(e.message),console.log("error",e)}).finally(function(){a.setState({showProgress:!1})})):a.error("No URL defined")},a.state={showProgress:!1,url:e.url},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.url&&this.import(),this.ref}},{key:"render",value:function(){var e=this;return n.a.createElement(St,Object.assign({name:"Import from URL"},this.props,{dragHandleClassName:"bp3-dialog-header"}),n.a.createElement("div",{className:"bp3-dialog-body"},n.a.createElement(xt.a,{helperText:n.a.createElement("span",null,"URL of the ",n.a.createElement("i",null,"raw")," model file"),label:"URL",labelFor:"import-url",labelInfo:"(required)"},n.a.createElement(Kt.a,{fill:!0,vertical:!1},n.a.createElement(Zt.a,{id:"import-url",ref:function(t){return e.ref=t},value:this.state.url,leftIcon:"cube",onChange:this.urlChange,placeholder:"https://example.com/my_model"}),n.a.createElement(pe.b,{icon:"import",intent:"primary",onClick:this.import},"Import"))),this.state.showProgress&&n.a.createElement(te.a,{intent:"primary"}),this.state.error&&n.a.createElement(de.a,{intent:"danger"},this.state.error)))}}]),t}(n.a.PureComponent),ta=(a(500),a(58)),aa=a(513),ra=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={data:e.data.slice(0)},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){for(var e="M 0 100 ",t=this.state.data,a=0,r=t.length;a<r;a++){e+="L "+100*a+" "+(100-t[a])+" "}return e+=" L 500 100 z",n.a.createElement("svg",{viewBox:"0 0 500 100",xmlSpace:"preserve"},n.a.createElement("linearGradient",{id:"gradient",gradientUnits:"userSpaceOnUse",x1:384,y1:100,x2:384,y2:0},n.a.createElement("stop",{offset:0,stopColor:this.props.bottomColor||"#ab700b"}),n.a.createElement("stop",{offset:1,stopColor:this.props.topColor||"#fb900b"})),n.a.createElement("path",{fill:"url(#gradient)",d:e}))}}]),t}(n.a.PureComponent),na=(a(501),a(502),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).inputRefs=[],a.currentFocus=0,a.focusHandler=function(e){a.currentFocus=parseInt(e.currentTarget.dataset.band||"0",10)||0},a.keyDown=function(e){var t=e.currentTarget.dataset.band,r=parseInt(t,10),n=a.props.values.concat();38===e.keyCode?(e.stopPropagation(),n[r]++):40===e.keyCode&&(e.stopPropagation(),n[r]--),a.props.onChange(n)},a.keyUp=function(e){38===e.keyCode?e.stopPropagation():40===e.keyCode?e.stopPropagation():13===e.keyCode&&a.props.onSubmit&&a.props.onSubmit()},a.valueChanged=function(e,t){var r=a.props.values.concat();r[e]=parseInt(t.target.value,10)||0,2===r[e].toString().length&&a.focusNext(),a.props.onChange&&a.props.onChange(r)},a.paste=function(e){var t=e.clipboardData.getData("Text").match(/(\d[,.]?\d*)/g);if(null!==t&&6===t.length){e.preventDefault();var r=t.map(function(e){return e.replace(",",".")}).map(function(e){return parseFloat(e)}),n=r.concat().sort().slice(-1)[0];r=n>1?r.map(function(e){return Math.round(e)}):r.map(function(e){return Math.round(100*e)}),console.log("pasted",r),a.props.onChange&&a.props.onChange(r)}},a.state={values:e.values.concat()},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){0!==this.inputRefs.length&&(this.inputRefs[0].focus(),this.inputRefs[0].select())}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"xen-band-data-entry"},this.props.values.map(function(t,a){return n.a.createElement("input",{"data-band":a.toString(),key:a,className:"bp3-input bp3-small",onKeyDown:e.keyDown,onKeyUp:e.keyUp,ref:function(t){return e.inputRefs[a]=t},value:e.props.values[a],disabled:e.props.disabled,onPaste:e.paste,onFocus:e.focusHandler,onChange:function(t){return e.valueChanged(a,t)}})}))}},{key:"focus",value:function(e){var t=this.inputRefs[e];void 0!==t&&(this.currentFocus=e,t.focus(),t.select())}},{key:"focusNext",value:function(){this.focus(this.currentFocus+1)}},{key:"focuPrev",value:function(){this.focus(this.currentFocus-1)}}]),t}(n.a.PureComponent)),ia=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).isBeingDragged=!1,a.prevD="M 0 100 L 0 100 L 100 100 L 200 100 L 300 100 L 400 100 L 500 100  L 500 100 z",a.height=void 0,a.width=void 0,a.svgRef=null,a.id=0,a.bandDataEntryRef=null,a.documentMouseUp=function(){a.isBeingDragged=!1},a.documentMouseMove=function(e){if(!0===a.isBeingDragged){var t=a.svgRef;if(null!==t){var r=t.getBoundingClientRect(),n=e.clientX-r.left,i=e.clientY-r.top;n=n.clamp(0,r.width),i=i.clamp(0,r.height);var o=r.width/(a.props.data.length-1),s=Math.floor((n+o/2)/o),c=1-i/r.height;a.setState({activeBand:s}),a.update(s,Math.round(100*c))}}},a.bandMouseMove=function(e){if(a.isBeingDragged){var t=e.clientY-e.target.getBoundingClientRect().top,r=parseInt(e.currentTarget.id,10),n=a.svgRef.getBoundingClientRect().height;a.update(r,Math.round(100-100*t/n))}},a.bandMouseDown=function(e){var t=parseInt(e.currentTarget.id,10),r=e.clientY-e.target.getBoundingClientRect().top,n=a.svgRef.getBoundingClientRect().height;a.update(t,Math.round(100-100*r/n)),a.isBeingDragged=!0},a.bandMouseUp=function(e){a.isBeingDragged=!1},a.bandWheel=function(e){var t=parseInt(e.currentTarget.id,10),r=e.deltaY;a.update(t,a.props.data[t]+(r<0?-1:1))},a.bandMouseEnter=function(e){e.currentTarget.style.opacity="0.1",a.setState({activeBand:parseInt(e.currentTarget.id,10)}),a.forceUpdate()},a.bandMouseLeave=function(e){e.currentTarget.style.opacity="0.0"},a.state={activeBand:0},a.height=a.props.height||100,a.width=a.props.width||500,a.id=t.id++,a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("mouseup",this.documentMouseUp),document.addEventListener("mousemove",this.documentMouseMove)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mouseup",this.documentMouseUp),document.removeEventListener("mousemove",this.documentMouseMove)}},{key:"render",value:function(){for(var e=this,t=100/(this.props.data.length-1),a=this.width/(this.props.data.length-1),r=[t/2],i=0;i<this.props.data.length-1;i++)r.push(t);r.push(t/2);for(var o="M 0 ".concat(this.height," "),s=this.props.data,c=0,l=s.length;c<l;c++){var u=s[c];o+="L "+c*a+" "+(this.height-this.height*u/100)+" "}o+=" L ".concat(this.width," ").concat(this.height," z");this.prevD;return this.prevD=o,n.a.createElement("div",{style:{width:"100%"}},n.a.createElement("div",{className:"xen-frequency-map-ui-x-legend",style:{opacity:this.props.disabled?.3:1}},n.a.createElement("span",null,"125"),n.a.createElement("span",null,"250"),n.a.createElement("span",null,"500"),n.a.createElement("span",null,"1k"),n.a.createElement("span",null,"2k"),n.a.createElement("span",null,"4k")),n.a.createElement("div",{className:"xen-frequency-map-ui-graph"},n.a.createElement("div",{className:"xen-frequency-map-ui-y-legend",style:{opacity:this.props.disabled?.3:1}},n.a.createElement("span",{style:{top:-8,right:10}},"100%"),n.a.createElement("span",{style:{bottom:-8,right:10}},"0%")),n.a.createElement("svg",{ref:function(t){return e.svgRef=t},className:"",viewBox:"0 0 ".concat(this.width," ").concat(this.height),xmlSpace:"preserve"},n.a.createElement("defs",null,n.a.createElement("pattern",{id:"xen-frequency-map-".concat(this.id,"-small-grid"),width:a/10,height:a/10,patternUnits:"userSpaceOnUse"},n.a.createElement("path",{d:"M ".concat(a/10+5," 0 L 0 0 0 ").concat(a/10),fill:"none",stroke:"gray",strokeWidth:"0.5"})),n.a.createElement("pattern",{id:"xen-frequency-map-".concat(this.id,"-grid"),width:a,height:a/2,patternUnits:"userSpaceOnUse"},n.a.createElement("rect",{width:a,height:a,fill:"url(#xen-frequency-map-".concat(this.id,"-small-grid)")}),n.a.createElement("path",{d:"M ".concat(a," 0 L 0 0 0 ").concat(a),fill:"none",stroke:"white",strokeWidth:"1"}))),n.a.createElement("rect",{height:"100%",y:"1",x:"1",fill:"url(#xen-frequency-map-".concat(this.id,"-grid)"),opacity:"0.9"}),n.a.createElement("linearGradient",{id:"xen-frequency-map-".concat(this.id,"-gradient"),gradientUnits:"userSpaceOnUse",x1:384,y1:"100%",x2:384,y2:0},n.a.createElement("stop",{offset:0,stopColor:this.props.bottomColor||"#ab700b"}),n.a.createElement("stop",{offset:1,stopColor:this.props.topColor||"#fb900b"})),n.a.createElement("path",{fill:"url(#xen-frequency-map-".concat(this.id,"-gradient)"),opacity:"0.8",d:o}),n.a.createElement("circle",{className:"xen-frequency-map-ui-band-handle",r:5,fill:this.props.topColor||"#fb900b",opacity:".8",cx:this.state.activeBand*a,cy:this.height-this.height*this.props.data[this.state.activeBand]/100}),r.map(function(a,r){return n.a.createElement("rect",{id:r.toString(),key:r.toString(),width:"".concat(t,"%"),x:"".concat(r*t-t/2,"%"),height:"100%",fill:"white",stroke:"black",opacity:"0.0",onMouseEnter:e.bandMouseEnter,onMouseLeave:e.bandMouseLeave,onMouseDown:e.bandMouseDown,onMouseUp:e.bandMouseUp,onMouseMove:e.bandMouseMove,onWheel:e.bandWheel,style:{cursor:"row-resize"}})}),this.props.disabled&&n.a.createElement("rect",{width:"100%",height:"100%",fill:"gray",opacity:".3"}))),n.a.createElement(na,{values:this.props.data,onChange:this.props.onChange,ref:function(t){return e.bandDataEntryRef=t},disabled:this.props.disabled,onSubmit:function(){return e.props.onSubmit&&e.props.onSubmit()}}))}},{key:"focus",value:function(e){null!==this.bandDataEntryRef&&this.bandDataEntryRef.focus(e)}},{key:"update",value:function(e,t){var a=this.props.data.concat();a[e]=t,this.focus(e),this.props.onChange(a)}}]),t}(n.a.PureComponent);ia.id=0;a(503);var oa=aa.a.ofType(),sa=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={absorption:[10,20,30,40,30,20],scatter:[10,10,10,10,10,10],value1:0,activeMaterial:null},a.absRef=null,a.sctRef=null,a.itemRenderer=function(e,t){return n.a.createElement(oe.a,{active:t.modifiers.active,disabled:t.modifiers.disabled,key:e.name,onClick:t.handleClick,text:n.a.createElement("div",{className:"material-select"},n.a.createElement("div",null,e.defaultValues&&n.a.createElement(me.a,{icon:"warning-sign",intent:"warning"})),n.a.createElement("div",null,e.name),n.a.createElement(ra,{data:e.absorption.values}))})},a.valueRenderer=function(e){return e.name},a.itemSelect=function(e){a.setState({absorption:e.absorption.values,scatter:e.scatter.values,activeMaterial:e}),a.absRef.focus(0)},a.listPredicate=function(e,t){return a.props.materials.filter(function(t){return t.name.toLocaleLowerCase().indexOf(e.toLocaleLowerCase())>=0})},a.createMaterial=function(e){return{name:e,absorption:S([1,1,1,1,1,1]),scatter:S([10,10,10,10,10,10]),defaultValues:!0}},a.createRenderer=function(e,t,a){return n.a.createElement(oe.a,{icon:"add",text:'Create "'.concat(e,'"'),active:t,onClick:a,shouldDismissPopover:!1})},a.absorptionChanged=function(e){a.setState({absorption:e.map(function(e){return e>100?100:e<0?0:e})},function(){j.getInstance().updateMaterial({name:a.state.activeMaterial.name,absorption:S(a.state.absorption),scatter:S(a.state.scatter),defaultValues:!1})})},a.scatterChanged=function(e){a.setState({scatter:e.map(function(e){return e>100?100:e<0?0:e})},function(){j.getInstance().updateMaterial({name:a.state.activeMaterial.name,absorption:S(a.state.absorption),scatter:S(a.state.scatter),defaultValues:!1})}),a.forceUpdate()},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=!1;return null!==this.state.activeMaterial?(this.state.activeMaterial.absorption.values,this.state.activeMaterial.scatter.values):t=!0,n.a.createElement(St,Object.assign({name:"Material Editor"},this.props,{dragHandleClassName:"bp3-dialog-header",width:465,height:486,enableResizing:{}}),n.a.createElement(bt.a,{style:{minWidth:200},fill:!0},n.a.createElement(pe.b,{icon:"reset",title:"Restore",disabled:t}),n.a.createElement(pe.b,{icon:"build",rightIcon:"caret-down",title:"Tools",disabled:t}),n.a.createElement(pe.b,{icon:"people",title:"Audience Calculator",disabled:!0}),n.a.createElement(oa,{fill:!0,items:this.props.materials,popoverProps:{minimal:!0,className:"xen-material-editor-cra-bug-fix"},itemRenderer:this.itemRenderer,inputValueRenderer:this.valueRenderer,onItemSelect:this.itemSelect,itemListPredicate:this.listPredicate,createNewItemFromQuery:this.createMaterial,createNewItemRenderer:this.createRenderer})),n.a.createElement("div",{className:"bp3-dialog-body"},n.a.createElement(ta.b,{style:{textAlign:"center"}},"Absorption Coefficiencts"),n.a.createElement(ia,{ref:function(t){return e.absRef=t},data:this.state.absorption,onChange:this.absorptionChanged,disabled:t,onSubmit:function(){return console.log("submit")}}),n.a.createElement(ta.b,{style:{textAlign:"center"}},"Scatter Coefficiencts"),n.a.createElement(ia,{ref:function(t){return e.sctRef=t},data:this.state.scatter,onChange:this.scatterChanged,disabled:t,bottomColor:"#337755",topColor:"#aaeecc"})))}},{key:"componentDidMount",value:function(){this.absRef.focus(0)}}]),t}(n.a.PureComponent),ca=function(){function e(t){Object(c.a)(this,e),this.model=t,this.volume=void 0,this.surface=void 0,this.materialStats=void 0,this.floorArea=0;for(var a=t.surfaces,r={},n=new v.Triangle,i=0,o=0,s=a.length;o<s;o++){var l=a[o],u=l.material;void 0===r[u.name]&&(r[u.name]=0);for(var d=l.geometry,h=d.faces,m=d.vertices,p=0,f=0,g=h.length;f<g;f++){var b=h[f],y=m[b.c],w=m[b.b],E=m[b.a];i+=y.x*w.y*E.z+y.y*w.z*E.x+y.z*w.x*E.y-y.x*w.z*E.y-y.y*w.x*E.z-y.z*w.y*E.x,n.set(y,w,E),p+=n.getArea()}l.isFloor&&(this.floorArea+=p),r[u.name]+=p}this.materialStats=r,i/=6,this.volume=i;var O=Object.values(r).reduce(function(e,t){return e+t},0);this.surface=O}return Object(l.a)(e,[{key:"meanHeight",get:function(){return this.volume/this.floorArea}}]),e}(),la=function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,null,[{key:"estimate2",value:function(e,t){var a=new g(24,58),r=[];return E.map(function(n){var i=0;Object.entries(t).map(function(e){var t=Object($e.a)(e,2),a=t[0],r=t[1],o=j.getInstance().getMaterial(a).absorption.get(n)/100;i+=o*r});var o=a.get(n);r.push(.161*e/(i+o*e))}),S(r)}}]),e}();Nt.a.registerTheme("dark",Wt);var ua=function(e){function t(e){return Object(c.a)(this,t),Object(u.a)(this,Object(d.a)(t).call(this,e))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.a.createElement(Ft.a,{echarts:Nt.a,option:this.getOptions(this.props.modelInfo.materialStats),theme:"dark",opts:{renderer:"svg"},style:{width:"100%",height:"250px"}})}},{key:"getOptions",value:function(e){return{backgroundColor:"#2c343c",title:{text:"Customized Pie",left:"center",top:20,textStyle:{color:"#ccc"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},visualMap:[{show:!1,min:80,max:600,inRange:{colorLightness:[0,1]}}],series:[{name:"Material Distribution",type:"pie",radius:"55%",center:["50%","50%"],data:Object.entries(e).map(function(e){return Object.assign({},{name:e[0]},{value:Math.round(e[1])})}).sort(function(e,t){return e.value-t.value}),roseType:!1,label:{normal:{textStyle:{color:"rgba(255, 255, 255, 0.3)"}}},labelLine:{normal:{lineStyle:{color:"rgba(255, 255, 255, 0.3)"},smooth:.2,length:10,length2:20}},itemStyle:{normal:{color:"#c23531",shadowBlur:200,shadowColor:"rgba(0, 0, 0, 0.5)"}},animationType:"scale",animationEasing:"elasticOut",animationDelay:function(){return 200*Math.random()}}]}}}]),t}(n.a.PureComponent),da=function(e){function t(e){return Object(c.a)(this,t),Object(u.a)(this,Object(d.a)(t).call(this,e))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=0;if("auto"===this.props.precision){var t=Math.abs(this.props.value);t<10?e=2:t<50&&(e=1)}else e=this.props.precision;var a=(+this.props.value.toFixed(e)).toString();if(!0!==this.props.omitUnit)switch(this.props.unit){case"m3":a+=" m\xb3";break;case"m2":a+=" m\xb2";break;default:a+=" "+this.props.unit}return n.a.createElement(he.a,{className:ce.a.TOOLTIP_INDICATOR,content:this.props.value.toString()},n.a.createElement("span",null,a))}}]),t}(n.a.PureComponent);da.defaultProps={precision:"auto"};a(504);var ha,ma=Ut.a.ofType();!function(e){e[e.A1=0]="A1",e[e.A2=1]="A2",e[e.A3=2]="A3",e[e.A4=3]="A4",e[e.A5=4]="A5",e[e.B1=5]="B1",e[e.B2=6]="B2",e[e.B3=7]="B3",e[e.B4=8]="B4",e[e.B5=9]="B5"}(ha||(ha={}));var pa=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).name="DIN 18041:2016",a.info=void 0,a.testClick=function(){a.props.validate(!1)},a.roomRenderer=function(e,t){return n.a.createElement(oe.a,{active:t.modifiers.active,disabled:t.modifiers.disabled,key:e.cateogry,text:n.a.createElement("div",null,e.description," and ",n.a.createElement("ul",null,e.examples.map(function(e){return n.a.createElement("li",{key:e},e)}))),onClick:t.handleClick})},a.roomSelect=function(e){console.log("room select",e),a.setState({activeRoom:e});var t=a.info.meanHeight,r=a.info.volume,n=new w({125:[.65,1.45],250:[.8,1.2],500:[.8,1.2],1000:[.8,1.2],2000:[.8,1.2],4000:[.65,1.2]}),i=new w({250:[.8,1.2],500:[.8,1.2],1000:[.8,1.2],2000:[.8,1.2]});switch(n,e.cateogry){case ha.A1:r>=30&&r<=1e3,a.t_soll(.45,.07);break;case ha.A2:r>=50&&r<=1e3,a.t_soll(.37,-.14);break;case ha.A3:r>=30&&r<=1e3,a.t_soll(.32,-.17);break;case ha.A4:r>=30&&r<=1e3,a.t_soll(.26,-.14);break;case ha.A5:i,r>=1e4?2:r>=200?a.t_soll(.75,-1):(a.t_soll(.75,-1),!1);break;case ha.B1:!0,-1;break;case ha.B2:t<=2.5?.15:1/(4.8+4.69*Math.log10(t));break;case ha.B3:t<=2.5?.2:1/(3.13+4.69*Math.log10(t));break;case ha.B4:t<=2.5?.25:1/(2.13+4.69*Math.log10(t));break;case ha.B5:t<=2.5?.3:1/(1.47+4.69*Math.log10(t));break;default:console.log("unknown room category")}},a.state={activeRoom:t.RoomTypes[0]},a.info=new ca(e.model),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return console.log("standard options re-render"),n.a.createElement("tr",null,n.a.createElement("td",null,"Usage"),n.a.createElement("td",null,n.a.createElement(ma,{items:t.RoomTypes,itemRenderer:this.roomRenderer,onItemSelect:this.roomSelect},n.a.createElement(pe.b,{text:this.state.activeRoom.description,rightIcon:"double-caret-vertical"}))))}},{key:"renderGraph",value:function(){throw new Error("Method not implemented.")}},{key:"t_soll",value:function(e,t){return e*Math.log10(this.info.volume)+t}}]),t}(n.a.PureComponent);pa.RoomTypes=[{cateogry:ha.A1,description:"Music",examples:["court","mourt","zourt"]},{cateogry:ha.A2,description:"borem tupsum",examples:["tourt","pourt","yourt"]},{cateogry:ha.A3,description:"borem tupsum",examples:["tourt","pourt","yourt"]},{cateogry:ha.A4,description:"borem tupsum",examples:["tourt","pourt","yourt"]},{cateogry:ha.A5,description:"borem tupsum",examples:["tourt","pourt","yourt"]},{cateogry:ha.B1,description:"Borem tupsum",examples:["tourt","pourt","yourt"]},{cateogry:ha.B2,description:"borem tupsum",examples:["tourt","pourt","yourt"]},{cateogry:ha.B3,description:"borem tupsum",examples:["tourt","pourt","yourt"]},{cateogry:ha.B4,description:"borem tupsum",examples:["tourt","pourt","yourt"]},{cateogry:ha.B5,description:"borem tupsum",examples:["tourt","pourt","yourt"]}];var fa,va=Ut.a.ofType();!function(e){e.DIN18041="DIN 18041:2016"}(fa||(fa={}));var ga=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).standards=[fa.DIN18041],a.renderStandardsUI=function(){var e={model:a.state.model,rt:a.state.rt,validate:a.validate};switch(a.state.activeStandard){case fa.DIN18041:return n.a.createElement(pa,e)}},a.testClick=function(){a.setState({rt:[Math.random(),Math.random(),Math.random(),Math.random(),Math.random(),Math.random()]})},a.standardRenderer=function(e,t){return n.a.createElement(oe.a,{active:t.modifiers.active,disabled:t.modifiers.disabled,key:e,text:e,onClick:t.handleClick})},a.standardSelect=function(e){a.setState({activeStandard:e})},a.validate=function(e){console.log("validate",e)},a.state={activeStandard:"Please choose a standard",model:a.props.model,rt:[]},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.a.createElement("table",{className:"bp3-html-table bp3-html-table-condensed bp3-html-table-striped"},n.a.createElement("tbody",null,n.a.createElement("tr",null,n.a.createElement("td",null,"Standard"),n.a.createElement("td",null,n.a.createElement(va,{filterable:!1,items:this.standards,itemRenderer:this.standardRenderer,onItemSelect:this.standardSelect},n.a.createElement(pe.b,{text:this.state.activeStandard,rightIcon:"double-caret-vertical"})),"\xa0",n.a.createElement("a",{href:"mailto:?subject=New Standard Request",className:"bp3-text-small"},"Request a new standard"))),this.renderStandardsUI()))}}]),t}(n.a.PureComponent),ba=(a(505),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).dragging=!1,a.ref=null,a.mouseMove=function(e){var t=e;a.dragging&&(console.log("mm",t.movementY),a.props.onKnobChange((a.props.value-t.movementY).clamp(0,100)))},a.mouseUp=function(e){a.dragging=!1},a.mouseDown=function(e){a.dragging=!0},a.wheel=function(e){e.preventDefault(),a.props.onKnobChange(Math.round(a.props.value+(e.deltaY>0?1:-1)).clamp(0,100))},a.mouseEnter=function(e){a.setState({color:"white"})},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousemove",this.mouseMove),document.addEventListener("mouseup",this.mouseUp),null!==this.ref&&this.ref.addEventListener("wheel",this.wheel)}},{key:"componentWillUnmount",value:function(){null!==this.ref&&this.ref.removeEventListener("wheel",this.wheel)}},{key:"render",value:function(){var e=this,a=Object.assign(t.Defaults,this.props);a.value=a.value.clamp(0,100);var r=5-a.railWidth+a.railWidth/2,i=2*Math.PI*r,o=i*(100-a.gapPercentage)/100,s=i/4*-1-i*a.gapPercentage/200,c=o*a.value/100,l=i-c;return n.a.createElement("svg",Object.assign({viewBox:"0 0 10 10",xmlSpace:"preserve"},a.svgProps,{className:"xen-ui-knob",ref:function(t){return e.ref=t},onMouseEnter:this.mouseEnter,onMouseDown:this.mouseDown}),n.a.createElement("circle",{r:r,cx:"5",cy:"5",fill:"transparent",stroke:a.backgroundColor,strokeWidth:a.railWidth,strokeDasharray:"".concat(o," ").concat(i-o),strokeDashoffset:s}),n.a.createElement("circle",{r:r,cx:"5",cy:"5",fill:"transparent",stroke:a.color,strokeWidth:a.railWidth,strokeDasharray:"".concat(c," ").concat(l),strokeDashoffset:s}))}}]),t}(n.a.PureComponent));ba.Defaults={backgroundColor:"#1c262d",color:"#1d7dbb",gapPercentage:10,railWidth:1,svgProps:{}};var ya=Ut.a.ofType(),wa=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).filterMaterial2=function(e,t){return a.props.materials.filter(function(t){return t.name.toLocaleLowerCase().indexOf(e.toLocaleLowerCase())>=0})},a.filterMaterial=function(e,t,a,r){return console.log("item predicate"),t.name.toLocaleLowerCase().indexOf(e.toLocaleLowerCase())>=0},a.itemRenderer=function(e,t){return t.modifiers.matchesPredicate?n.a.createElement(oe.a,{active:t.modifiers.active,disabled:t.modifiers.disabled,key:e.name,onClick:t.handleClick,text:n.a.createElement("div",{className:"material-select"},n.a.createElement("div",null,e.name),n.a.createElement(ra,{data:e.absorption.values}))}):null},a.itemSelect=function(e,t){var r=Object.assign({},a.state);r.covers[e]=t.name,a.setState(r),a.forceUpdate()},a.bandChanged=function(e){console.log(e)},a.state={randomRT:[],covers:{},coverPercentages:{}},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=new ca(this.props.model),a=Object.assign({},t.materialStats);return Object.keys(a).forEach(function(t){if(void 0!==e.state.covers[t]){var r=e.state.coverPercentages[t]||0,n=e.state.covers[t],i=a[t];a[t]=i*(100-r)/100,void 0===a[n]&&(a[n]=0),a[n]+=i*r/100}}),n.a.createElement(St,Object.assign({name:"Sabine",icon:"bp3-icon-regression-chart",width:450,height:500,dragHandleClassName:"bp3-dialog-header"},this.props),n.a.createElement("div",{className:"xen-sabine-ui"},n.a.createElement(Lt.a,{animate:!1},n.a.createElement(Pt.a,{id:"rt",title:"Reverberation",panel:n.a.createElement(Ht,{rt:la.estimate2(t.volume,a).values})}),n.a.createElement(Pt.a,{id:"md",title:"Materials",panel:n.a.createElement(ua,{modelInfo:t})})),n.a.createElement("div",{className:"secondary-body"},n.a.createElement(ga,{model:this.props.model}),n.a.createElement("table",{className:"bp3-html-table bp3-html-table-condensed bp3-html-table-striped"},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",null,"Metric"),n.a.createElement("th",null,"Value"))),n.a.createElement("tbody",null,n.a.createElement("tr",null,n.a.createElement("td",null,"Volume"),n.a.createElement("td",null,n.a.createElement(da,{value:t.volume,unit:"m3"}))),n.a.createElement("tr",null,n.a.createElement("td",null,"Surfrace area"),n.a.createElement("td",null,n.a.createElement(da,{value:t.surface,unit:"m2"}))),n.a.createElement("tr",null,n.a.createElement("td",null,"Mean height"),n.a.createElement("td",null,n.a.createElement(da,{value:t.meanHeight,unit:"m"}))))),n.a.createElement("table",{className:"bp3-html-table bp3-html-table-condensed bp3-html-table-striped bp3-fill"},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",null,"Current Material"),n.a.createElement("th",null,"Area (m\xb2)"),n.a.createElement("th",null,"Cover Material",n.a.createElement(pe.b,{icon:"reset",minimal:!0,title:"Reset",onClick:function(){return e.setState({covers:{}})}})),n.a.createElement("th",null,"Cover Percentage"))),n.a.createElement("tbody",null,Object.entries(t.materialStats).map(function(t,a){return n.a.createElement("tr",{key:t[0]},n.a.createElement("td",null,t[0]),n.a.createElement("td",null,n.a.createElement(da,{value:t[1],unit:"m2",omitUnit:!0})),n.a.createElement("td",null,n.a.createElement(ya,{items:e.props.materials,itemRenderer:e.itemRenderer,onItemSelect:function(a){return e.itemSelect(t[0],a)},itemPredicate:e.filterMaterial,itemListPredicate:e.filterMaterial2,popoverProps:{modifiers:{preventOverflow:{boundariesElement:"window"}},position:"auto"}},n.a.createElement(pe.b,{text:e.state.covers[t[0]]||"Select a material",rightIcon:"double-caret-vertical"})),n.a.createElement(pe.b,{icon:"reset",minimal:!0,title:"Reset",onClick:function(){var a=Object.assign({},e.state);delete a.covers[t[0]],e.setState(a),e.forceUpdate()}})),n.a.createElement("td",null,void 0!==e.state.covers[t[0]]&&n.a.createElement("div",{className:"percentage"},n.a.createElement(ba,{value:e.state.coverPercentages[t[0]]||0,onKnobChange:function(a){var r=Object.assign({},e.state.coverPercentages);r[t[0]]=a,e.setState({coverPercentages:r})}}),e.state.coverPercentages[t[0]]>0&&n.a.createElement("div",null,e.state.coverPercentages[t[0]],"% \xa0 ",n.a.createElement(da,{value:t[1]*e.state.coverPercentages[t[0]]/100,unit:"m2"})))))}))))))}}]),t}(n.a.PureComponent),Ea=a(267),Oa=a(254),Sa=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).toggle=function(){a.setState(function(e){e.isA?(a.props.actionA(),a.setState({isA:!1,text:a.props.textB})):(a.props.actionB(),a.setState({isA:!0,text:a.props.textA}))})},a.state={isA:!0,text:a.props.textA},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.a.createElement("a",{onClick:this.toggle},this.state.text)}}]),t}(n.a.PureComponent),ka=function(e){function t(e){var a;if(Object(c.a)(this,t),a=Object(u.a)(this,Object(d.a)(t).call(this,e)),void 0!==t.instance)throw new Error("Only one instance of Help Drawer is allowed");return t.instance=Object(m.a)(Object(m.a)(a)),a.state={show:!1,content:n.a.createElement("div",null),size:Oa.a.SIZE_SMALL},a}return Object(h.a)(t,e),Object(l.a)(t,null,[{key:"show",value:function(e){if(void 0===t.instance)throw new Error("");t.instance.setState({content:e,show:!0})}}]),Object(l.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement(Oa.a,{className:"bp3-dark",icon:"info-sign",title:"Help",size:this.state.size,isOpen:this.state.show,onClose:function(){return e.setState({show:!1})}},n.a.createElement("div",{className:ce.a.DRAWER_BODY},n.a.createElement("div",{className:ce.a.DIALOG_BODY},this.state.content)),n.a.createElement("div",{className:ce.a.DRAWER_FOOTER},n.a.createElement(Sa,{actionA:function(){return e.setState({size:Oa.a.SIZE_STANDARD})},textA:"<< Index",actionB:function(){return e.setState({size:Oa.a.SIZE_SMALL})},textB:">> Index"})))}}]),t}(n.a.PureComponent);ka.instance=void 0;var ja={autoFocus:!1,modifiers:{preventOverflow:{boundariesElement:"viewport"}},position:"top"},xa=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).lastModelTimestamp="",a.clipboardDisabled=!1,a.receiverMissing=!0,a.sourceMissing=!0,a.materialsNeedsUpdate=!0,a.componentDidMount=function(){window.addEventListener("focus",a.focus)},a.windows=function(){var e=[];if(a.state.showImportFromURL?e.push(n.a.createElement(ea,{onLoad:a.downloaded,url:a.state.importURL,onClose:function(){return a.setState({importURL:void 0,showImportFromURL:!1})}})):e.push(n.a.createElement("div",{key:"window-placeholder-import-url"})),a.state.showFileUpload?e.push(n.a.createElement(jt,{onClose:function(){return a.setState({showFileUpload:!1})}})):e.push(n.a.createElement("div",{key:"window-placeholder-file-upload"})),a.state.showGeometricalAnalysis){var t=a.props.view;a.props.model?e.push(n.a.createElement(Yt,{key:"GeometricalAnalysis",model:a.props.model,tracerMaster:t.tracerMaster,scene:t.scene,jobs:t.jobsRef.current,onClose:function(){return a.setState({showGeometricalAnalysis:!1})}})):(console.log("pretty alert error message load a model"),e.push(n.a.createElement("div",{key:"window-placeholder-ga"})))}else e.push(n.a.createElement("div",{key:"window-placeholder-ga"}));return a.state.showStatisticalAnalysis?a.props.model?e.push(n.a.createElement(wa,{model:a.props.model,materials:a.props.materials,onClose:function(){return a.setState({showStatisticalAnalysis:!1})}})):(console.log("pretty alert error message load a model"),e.push(n.a.createElement("div",{key:"window-placeholder-sa"}))):e.push(n.a.createElement("div",{key:"window-placeholder-sa"})),a.state.showMaterials?e.push(n.a.createElement(sa,{materials:a.props.materials,onClose:function(){return a.setState({showMaterials:!1})}})):e.push(n.a.createElement("div",{key:"window-placeholder-mateiral-editor"})),a.state.showAbout?e.push(n.a.createElement(kt,{onClose:function(){return a.setState({showAbout:!1})}})):e.push(n.a.createElement("div",{key:"window-placeholder-about"})),e},a.downloaded=function(e){a.setState({showImportFromURL:!1}),a.props.view.loadModel(e)},a.importMenu=function(){return n.a.createElement(ne.a,null,n.a.createElement(oe.a,{icon:"document-open",text:"From local file...",onClick:function(){return a.setState({showFileUpload:!0})}}),n.a.createElement(oe.a,{icon:"globe-network",text:"From url...",onClick:function(){return a.setState({showImportFromURL:!0,importURL:void 0})}}),n.a.createElement(oe.a,{text:n.a.createElement("div",{className:"xen-main-menu-checkbox",onClick:function(e){e.stopPropagation()}},n.a.createElement(gt.a,{disabled:a.clipboardDisabled,checked:!a.clipboardDisabled&&a.state.autoImport,onChange:function(){return a.setState(function(e,t){return a.setState({autoImport:!e.autoImport})})}},"Auto-Sync with SketchUp"))},n.a.createElement(oe.a,{icon:"download",text:n.a.createElement("a",{href:"sketchup-sync.rbz"},"Download SketchUp extension")})),n.a.createElement(oe.a,{icon:"export",text:"Export"},n.a.createElement(oe.a,{icon:"cube",text:"Collada",onClick:a.exportCollada}),n.a.createElement(oe.a,{icon:"cube",text:"CATT",onClick:a.exportCATT})),n.a.createElement(ie.a,null),n.a.createElement(oe.a,{icon:"cube",text:"Real world examples..."},n.a.createElement(oe.a,{icon:"cube",text:"Worship place",onClick:function(){return a.setState({importURL:"/demo/worship-place.json",showImportFromURL:!0})}}),n.a.createElement(oe.a,{icon:"cube",text:"Commercial cafeteria",onClick:function(){return a.setState({importURL:"/demo/commercial-cafeteria.json",showImportFromURL:!0})}})))},a.analysisMenu=function(){return n.a.createElement(ne.a,null,n.a.createElement(oe.a,{icon:"regression-chart",text:n.a.createElement(he.a,{content:n.a.createElement("span",null,"You need to enter material data to enable statistical analysis"),modifiers:{preventOverflow:{boundariesElement:"window"}},disabled:!a.materialsNeedsUpdate},"Statistical"),disabled:a.materialsNeedsUpdate||null===a.props.model,onClick:function(){return a.setState({showStatisticalAnalysis:!0})}}),n.a.createElement(oe.a,{icon:"pivot",text:"Geometrical",disabled:a.materialsNeedsUpdate||a.sourceMissing||a.receiverMissing,onClick:function(){return a.setState({showGeometricalAnalysis:!0})}}),n.a.createElement(ie.a,null),n.a.createElement(oe.a,{icon:"pivot",disabled:!0,text:n.a.createElement(he.a,{content:"Early reflection point analysis",hoverOpenDelay:1e3,boundary:"viewport"},"Early Reflections")}))},a.statusMenu=function(){var e="tick-circle",t="success",r=[];return null!==a.props.model&&((a.materialsNeedsUpdate||a.sourceMissing||a.receiverMissing)&&(e="warning-sign",t="warning"),a.materialsNeedsUpdate&&r.push({key:"materialMessage",icon:n.a.createElement(Me,null),text:n.a.createElement("span",null,"Some materials are inserted into the database with default values. Statistical and geometrical analysis will not be available until you enter actual absorption and scater coefficient for these materials."),action:function(){return a.setState({showMaterials:!0})}}),a.sourceMissing&&r.push({key:"sourceMessage",icon:n.a.createElement(ze,null),text:n.a.createElement("span",null,"There are no sources in the model. Geometrical analysis will be disabled.")}),a.receiverMissing&&r.push({key:"receiverMessage",icon:n.a.createElement(Ae,null),text:n.a.createElement("span",null,"There are no receivers in the model. Geometrical analysis will be disabled.")})),0===r.length&&r.push({key:"okMessage",icon:n.a.createElement(me.a,{icon:"tick-circle"}),text:n.a.createElement("span",null,"Everything looks fine")}),n.a.createElement(re.a,Object.assign({content:n.a.createElement("div",{className:"xen-main-menu-status-messages"},r.map(function(e){return n.a.createElement("div",{key:e.key,onClick:e.action?e.action:function(){},className:e.action&&ce.a.POPOVER_DISMISS,style:{cursor:e.action?"pointer":"inherit"}},n.a.createElement("span",{className:"bp3-icon"},e.icon),e.text)}))},ja),n.a.createElement(pe.b,{icon:e,intent:t}))},a.import=function(){console.log("import"),a.setState({showImportFromURL:!0})},a.focus=function(){if(a.state.autoImport)if(Et.ClipboardAPI){navigator.clipboard.readText().then(function(e){if(e.startsWith("###EAAS$$$")){var t=e.substr("###EAAS$$$".length,13);if(t===a.lastModelTimestamp)return;a.lastModelTimestamp=t;var r=e.substr("###EAAS$$$".length+13),n=JSON.parse(r);a.props.view.loadModel(n)}}).catch(function(){console.log("focus error")})}else console.log("Clipboard API not available")},a.checkModelHealth=function(){var e=a.props.model;a.receiverMissing=!0,a.sourceMissing=!0,null!==e&&(a.receiverMissing=0===e.receivers.length,a.sourceMissing=0===e.sources.length),a.materialsNeedsUpdate=a.props.materials.filter(function(e){return e.defaultValues}).length>0},a.exportCollada=function(){var e=(new Ea.a).parse(a.props.view.scene,function(){},{author:"Xenakis"}),t=new Blob([e.data],{type:"model/vnd.collada+xml"});wt.a.saveAs(t,"test.dae")},a.exportCATT=function(){var e=a.props.model;if(null!==e){var t=e.surfaces.map(function(e){return e.material.name}).filter(R).map(function(e){var t=j.getInstance().getMaterial(e),a=t.absorption.values,r=t.scatter.values;return"ABS ".concat(e," = <").concat(a[0]," ").concat(a[1]," ").concat(a[2]," ").concat(a[3]," ").concat(a[4]," ").concat(a[5],"> L <").concat(r[0]," ").concat(r[1]," ").concat(r[2]," ").concat(r[3]," ").concat(r[4]," ").concat(r[5],">")});console.log(t.join("\n"))}},a.state={autoImport:!0,showAbout:!1,showGeometricalAnalysis:!1,showStatisticalAnalysis:!1,showImportFromURL:!1,showFileUpload:!1,showSettings:!1,showMaterials:!1,statusIcon:"tick-circle",statusIntent:"success"},a.clipboardDisabled=!(navigator.clipboard&&"function"===typeof navigator.clipboard.readText),a.focus(),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return this.checkModelHealth(),n.a.createElement("div",null,n.a.createElement(St,Object.assign({name:"MainMenu"},this.props,{hideTitleBar:!0,minHeight:25,maxHeight:25,minWidth:432,maxWidth:432,enableResizing:{},dragHandleClassName:"xen-main-menu-handle"}),n.a.createElement(bt.a,{fill:!0},n.a.createElement(pe.b,{icon:"drag-handle-vertical",className:"xen-main-menu-handle",disabled:!0,minimal:!0,title:"File"}),n.a.createElement(re.a,Object.assign({content:this.importMenu()},ja),n.a.createElement(pe.b,{icon:"document",rightIcon:"caret-down",title:"Import"},"File")),n.a.createElement(re.a,Object.assign({content:this.analysisMenu()},ja),n.a.createElement(pe.b,{icon:"predictive-analysis",rightIcon:"caret-down",title:"Analysis"},"Analysis")),n.a.createElement(pe.b,{icon:n.a.createElement("span",{className:"bp3-icon"},n.a.createElement(Me,null)),title:"Materials",onClick:function(){return e.setState({showMaterials:!0})}},"Materials"),n.a.createElement(pe.b,{icon:"cog",disabled:!0},"Settings"),n.a.createElement(pe.b,{icon:"info-sign",onClick:function(){return ka.show(n.a.createElement("div",null,"hello"))}},"Docs"),this.statusMenu())),this.windows())}}]),t}(n.a.PureComponent),Ma=function(e){function t(e,a){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(d.a)(t).call(this,e,a))).isSelectable=!0,r.normalMaterial=void 0,r.selected=!1,r.highlighted=!1,r.normalMaterial=a,r}return Object(h.a)(t,e),Object(l.a)(t,[{key:"highlight",value:function(){!0!==this.highlighted&&(this.highlighted=!0,this.update())}},{key:"unhighlight",value:function(){!1!==this.highlighted&&(this.highlighted=!1,this.update())}},{key:"select",value:function(){!0!==this.selected&&(this.selected=!0,this.update())}},{key:"unselect",value:function(){!1!==this.selected&&(this.selected=!1,this.update())}},{key:"toggleSelect",value:function(){this.selected=!this.selected,this.update()}},{key:"update",value:function(){this.selected?this.material=t.SELECT_MATERIAL:this.highlighted?this.material=t.HIGHLIGHT_MATERIAL:this.material=this.normalMaterial}}]),t}(v.Mesh);Ma.HIGHLIGHT_MATERIAL=new v.MeshBasicMaterial({color:16711680}),Ma.SELECT_MATERIAL=new v.MeshBasicMaterial({color:16711935});var Ca=function(e){function t(e,a){return Object(c.a)(this,t),Object(u.a)(this,Object(d.a)(t).call(this,e,a))}return Object(h.a)(t,e),t}(Ma),Ia=a(506)(v),Da=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).airAbsorption=new g(20,50),a.tracerMaster=void 0,a.renderer=void 0,a.frameId=void 0,a.scene=void 0,a.camera=void 0,a.controls=void 0,a.ref=void 0,a.contextTarget=void 0,a.contextMenu=void 0,a.stats=void 0,a.sources={},a.receivers={},a.odds=0,a.chartData=[],a.jobsRef=void 0,a.rayCaster=void 0,a.mouse=new v.Vector2,a.surfaces=[],a.intersected=null,a.modelGroup=new v.Group,a.materialManager=j.getInstance(),a.componentDidMount=function(){window.addEventListener("resize",a.updateDimensions),a.ref.current.appendChild(a.renderer.domElement),a.renderer.domElement.addEventListener("mousemove",a.onCanvasMouseMove,!1),a.renderer.domElement.addEventListener("contextmenu",a.onCanvasContextMenu,!1),a.renderer.domElement.addEventListener("click",a.onCanvasClick,!1),a.start(),a.forceUpdate()},a.start=function(){a.frameId||(a.frameId=requestAnimationFrame(a.animate))},a.stop=function(){cancelAnimationFrame(a.frameId)},a.receiverUpdate=function(e){console.log(e),a.setState({receivers:e})},a.iterationCompleted=function(){console.log("itereation completed")},a.loadModel=function(e){a.tracerMaster.setEnvironment(24,58),a.tracerMaster.loadModel(e),a.scene.remove(a.modelGroup),a.modelGroup=new v.Group,a.scene.add(a.modelGroup),a.sources={},a.receivers={},a.surfaces=[];var t=G.load(e,Object(m.a)(Object(m.a)(a)));a.setState({model:t})},a.render=function(){return n.a.createElement("div",{className:"bp3-dark"},n.a.createElement(ae,{ref:a.jobsRef}),n.a.createElement("div",{ref:a.ref,onClick:function(e){return a.setState({popoverShow:!1})}}),n.a.createElement("div",{className:"HUD"},n.a.createElement(xa,{model:a.state.model,materials:a.state.materials,view:Object(m.a)(Object(m.a)(a)),y:0}),n.a.createElement(re.a,{isOpen:a.state.popoverShow,usePortal:!0},n.a.createElement("div",{style:{position:"absolute"},ref:a.contextTarget}),n.a.createElement("div",{onClick:function(e){return e.stopPropagation()},style:{position:"absolute"},ref:a.contextMenu}))),n.a.createElement(ka,null),n.a.createElement(vt,{view:Object(m.a)(Object(m.a)(a)),materials:a.state.materials}))},a.materialChange=function(e){a.setState({materials:e})},a.renderScene=function(){a.renderer.render(a.scene,a.camera)},a.animate=function(){a.frameId=window.requestAnimationFrame(a.animate),a.odds++%2!==0&&(a.highlight(),a.renderScene(),a.stats.update())},a.updateDimensions=function(){a.camera.aspect=window.innerWidth/window.innerHeight,a.camera.updateProjectionMatrix(),a.renderer.setSize(window.innerWidth,window.innerHeight)},a.onCanvasMouseMove=function(e){a.mouse.x=e.clientX/window.innerWidth*2-1,a.mouse.y=-e.clientY/window.innerHeight*2+1},a.onCanvasClick=function(e){null!==a.intersected&&console.log(a.intersected.normalMaterial.absorption)},a.onCanvasContextMenu=function(e){},a.renderer=new v.WebGLRenderer({antialias:!(window.devicePixelRatio>1)}),a.renderer.setPixelRatio(window.devicePixelRatio),a.renderer.setSize(window.innerWidth,window.innerHeight),v.Object3D.DefaultUp.set(0,0,1),a.scene=new v.Scene,a.scene.background=new v.Color(0),a.camera=new v.PerspectiveCamera(60,window.innerWidth/window.innerHeight,1,9999999),a.controls=new Ia(a.camera,a.renderer.domElement),a.stats=new f.a,a.ref=n.a.createRef(),a.contextTarget=n.a.createRef(),a.contextMenu=n.a.createRef(),a.jobsRef=n.a.createRef(),a.frameId=0,a.materialManager.addListener("change",a.materialChange),a.airAbsorption=new g(24,58),a.tracerMaster=new Z,a.camera.position.x=32,a.camera.position.y=32,a.camera.position.z=32,a.controls.update(),a.initLights(),a.initGuides(),a.state={data:{drawCount:1e3,drawFrom:0,orderCount:1,orderFrom:0,rays:1e3},dialogs:[],receivers:{},reflectogram:[],diffMap:[],reflectogramAggregator:new H([]),cancelSimulation:!1,toaster:void 0,iteration:1e3,popoverShow:!1,surfaces:a.surfaces,model:null,showDropGuide:!0,materials:a.materialManager.get()},a.scene.add(a.modelGroup),a.rayCaster=new v.Raycaster,a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"addSurface",value:function(e){this.surfaces.push(e),this.modelGroup.add(new Ca(e.geometry,e.material))}},{key:"modelInit",value:function(){this.surfaces=[]}},{key:"modelDone",value:function(){}},{key:"addReceiver",value:function(e){var a=new v.SphereBufferGeometry(.5,8,8),r=new Ma(a,t.receiverMaterial);r.position.copy(e.center),r.updateMatrix(),r.updateMatrixWorld(),this.modelGroup.add(r),this.receivers[e.name]=r,this.chartData.push([])}},{key:"addSource",value:function(e){var a=new v.SphereBufferGeometry(.1,8,8),r=new Ma(a,t.sourceMaterial);r.position.copy(e.position.clone()),r.updateMatrix(),r.updateMatrixWorld(),this.sources[e.name]=r,this.modelGroup.add(r)}},{key:"highlight",value:function(){this.rayCaster.setFromCamera(this.mouse,this.camera);var e=this.rayCaster.intersectObjects(this.modelGroup.children);if(e.length>0){if(this.intersected!==e[0].object){if(void 0===e[0].object.isSelectable)return;null!==this.intersected&&this.intersected.unhighlight(),this.intersected=e[0].object,this.intersected.highlight()}}else null!==this.intersected&&this.intersected.unhighlight(),this.intersected=null}},{key:"initLights",value:function(){var e=new v.AmbientLight(16777215,.5);this.scene.add(e);var t=[new v.PointLight(16777215,.5,0),new v.PointLight(16777215,.5,0),new v.PointLight(16777215,1,0)];t[0].position.set(0,200,0),t[1].position.set(100,200,1e3),t[2].position.set(-100,-200,1e3),this.scene.add(t[0]),this.scene.add(t[1]),this.scene.add(t[2])}},{key:"initGuides",value:function(){var e=this;function t(t,a,r){var n=new v.LineDashedMaterial({color:r}),i=new v.Geometry;i.vertices.push(t),i.vertices.push(a),e.scene.add(new v.Line(i,n))}t(new v.Vector3(0,0,0),new v.Vector3(1e4,0,0),16711680),t(new v.Vector3(-1e4,0,0),new v.Vector3(0,0,0),16742263),t(new v.Vector3(0,0,0),new v.Vector3(0,1e4,0),65280),t(new v.Vector3(0,-1e4,0),new v.Vector3(0,0,0),8978312),t(new v.Vector3(0,0,0),new v.Vector3(0,0,1e4),255),t(new v.Vector3(0,0,-1e4),new v.Vector3(0,0,0),7829503)}},{key:"generateMenu",value:function(){return n.a.createElement(ne.a,{key:"menu"},n.a.createElement(ie.a,{title:"Edit"}),n.a.createElement(oe.a,{icon:"info-sign",text:"Info",label:"\u2318X"}),n.a.createElement(oe.a,{icon:"duplicate",text:"Copy",label:"\u2318C"}),n.a.createElement(oe.a,{icon:"clipboard",text:"Paste",label:"\u2318V",disabled:!0}),n.a.createElement(ie.a,{title:"Text"}),n.a.createElement(oe.a,{icon:"align-left",text:"Alignment"},n.a.createElement(oe.a,{icon:"align-left",text:"Left"}),n.a.createElement(oe.a,{icon:"align-center",text:"Center"}),n.a.createElement(oe.a,{icon:"align-right",text:"Right"}),n.a.createElement(oe.a,{icon:"align-justify",text:"Justify"})),n.a.createElement(oe.a,{icon:"style",text:"Style"},n.a.createElement(oe.a,{icon:"bold",text:"Bold"}),n.a.createElement(oe.a,{icon:"italic",text:"Italic"}),n.a.createElement(oe.a,{icon:"underline",text:"Underline"})))}}]),t}(n.a.Component);Da.receiverMaterial=new v.MeshPhongMaterial({color:5616265,emissive:468276,flatShading:!0,vertexColors:v.VertexColors,wireframe:!1}),Da.sourceMaterial=new v.MeshPhongMaterial({color:16065049,emissive:468276,flatShading:!0,vertexColors:v.VertexColors,wireframe:!1});a(508);o.a.render(n.a.createElement(s.AppContainer,null,function(){return Et.SharedArrayBuffer?n.a.createElement(Da,null):(e="Sorry your browser doesn't support a critical feature (SharedArrayBuffer).",n.a.createElement("div",{className:"xen-no-browser-support"},e,n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("span",null,"At the moment only ",n.a.createElement("a",{href:"https://www.google.com/chrome/"},"Chrome desktop")," is supported. ",n.a.createElement("br",null),"Use other browsers at your own risk.")));var e}()),document.getElementById("view")),console.log("no hot support")},81:function(e){e.exports={color:["#dd6b66","#759aa0","#e69d87","#8dc1a9","#ea7e53","#eedd78","#73a373","#73b9bc","#7289ab","#91ca8c","#f49f42"],backgroundColor:"#1a1a1a",textStyle:{},title:{textStyle:{color:"#eeeeee"},subtextStyle:{color:"#aaaaaa"}},line:{itemStyle:{normal:{borderWidth:1}},lineStyle:{normal:{width:2}},symbolSize:4,symbol:"circle",smooth:!1},radar:{itemStyle:{normal:{borderWidth:1}},lineStyle:{normal:{width:2}},symbolSize:4,symbol:"circle",smooth:!1},bar:{itemStyle:{normal:{barBorderWidth:0,barBorderColor:"#ccc"},emphasis:{barBorderWidth:0,barBorderColor:"#ccc"}}},pie:{itemStyle:{normal:{borderWidth:0,borderColor:"#ccc"},emphasis:{borderWidth:0,borderColor:"#ccc"}}},scatter:{itemStyle:{normal:{borderWidth:0,borderColor:"#ccc"},emphasis:{borderWidth:0,borderColor:"#ccc"}}},boxplot:{itemStyle:{normal:{borderWidth:0,borderColor:"#ccc"},emphasis:{borderWidth:0,borderColor:"#ccc"}}},parallel:{itemStyle:{normal:{borderWidth:0,borderColor:"#ccc"},emphasis:{borderWidth:0,borderColor:"#ccc"}}},sankey:{itemStyle:{normal:{borderWidth:0,borderColor:"#ccc"},emphasis:{borderWidth:0,borderColor:"#ccc"}}},funnel:{itemStyle:{normal:{borderWidth:0,borderColor:"#ccc"},emphasis:{borderWidth:0,borderColor:"#ccc"}}},gauge:{itemStyle:{normal:{borderWidth:0,borderColor:"#ccc"},emphasis:{borderWidth:0,borderColor:"#ccc"}}},candlestick:{itemStyle:{normal:{color:"#fd1050",color0:"#0cf49b",borderColor:"#fd1050",borderColor0:"#0cf49b",borderWidth:1}}},graph:{itemStyle:{normal:{borderWidth:0,borderColor:"#ccc"}},lineStyle:{normal:{width:1,color:"#aaaaaa"}},symbolSize:4,symbol:"circle",smooth:!1,color:["#dd6b66","#759aa0","#e69d87","#8dc1a9","#ea7e53","#eedd78","#73a373","#73b9bc","#7289ab","#91ca8c","#f49f42"],label:{normal:{textStyle:{color:"#eeeeee"}}}},map:{itemStyle:{normal:{areaColor:"#eeeeee",borderColor:"#444444",borderWidth:.5},emphasis:{areaColor:"rgba(255,215,0,0.8)",borderColor:"#444444",borderWidth:1}},label:{normal:{textStyle:{color:"#000000"}},emphasis:{textStyle:{color:"rgb(100,0,0)"}}}},geo:{itemStyle:{normal:{areaColor:"#eeeeee",borderColor:"#444444",borderWidth:.5},emphasis:{areaColor:"rgba(255,215,0,0.8)",borderColor:"#444444",borderWidth:1}},label:{normal:{textStyle:{color:"#000000"}},emphasis:{textStyle:{color:"rgb(100,0,0)"}}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#eeeeee"}},axisTick:{show:!0,lineStyle:{color:"#eeeeee"}},axisLabel:{show:!0,textStyle:{color:"#eeeeee"}},splitLine:{show:!0,lineStyle:{color:["#aaaaaa"]}},splitArea:{show:!1,areaStyle:{color:["#eeeeee"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#eeeeee"}},axisTick:{show:!0,lineStyle:{color:"#eeeeee"}},axisLabel:{show:!0,textStyle:{color:"#eeeeee"}},splitLine:{show:!0,lineStyle:{color:["#aaaaaa"]}},splitArea:{show:!1,areaStyle:{color:["#eeeeee"]}}},logAxis:{axisLine:{show:!0,lineStyle:{color:"#eeeeee"}},axisTick:{show:!0,lineStyle:{color:"#eeeeee"}},axisLabel:{show:!0,textStyle:{color:"#eeeeee"}},splitLine:{show:!0,lineStyle:{color:["#aaaaaa"]}},splitArea:{show:!1,areaStyle:{color:["#eeeeee"]}}},timeAxis:{axisLine:{show:!0,lineStyle:{color:"#eeeeee"}},axisTick:{show:!0,lineStyle:{color:"#eeeeee"}},axisLabel:{show:!0,textStyle:{color:"#eeeeee"}},splitLine:{show:!0,lineStyle:{color:["#aaaaaa"]}},splitArea:{show:!1,areaStyle:{color:["#eeeeee"]}}},toolbox:{iconStyle:{normal:{borderColor:"#999999"},emphasis:{borderColor:"#666666"}}},legend:{textStyle:{color:"#eeeeee"}},tooltip:{axisPointer:{lineStyle:{color:"#eeeeee",width:"1"},crossStyle:{color:"#eeeeee",width:"1"}}},timeline:{lineStyle:{color:"#eeeeee",width:1},itemStyle:{normal:{color:"#dd6b66",borderWidth:1},emphasis:{color:"#a9334c"}},controlStyle:{normal:{color:"#eeeeee",borderColor:"#eeeeee",borderWidth:.5},emphasis:{color:"#eeeeee",borderColor:"#eeeeee",borderWidth:.5}},checkpointStyle:{color:"#e43c59",borderColor:"rgba(194,53,49,0.5)"},label:{normal:{textStyle:{color:"#eeeeee"}},emphasis:{textStyle:{color:"#eeeeee"}}}},visualMap:{color:["#bf444c","#d88273","#f6efa6"]},dataZoom:{backgroundColor:"rgba(47,69,84,0)",dataBackgroundColor:"rgba(255,255,255,0.3)",fillerColor:"rgba(167,183,204,0.4)",handleColor:"#a7b7cc",handleSize:"100%",textStyle:{color:"#eeeeee"}},markPoint:{label:{normal:{textStyle:{color:"#eeeeee"}},emphasis:{textStyle:{color:"#eeeeee"}}}}}}},[[306,1,2]]]);
//# sourceMappingURL=main.66ec6e84.chunk.js.map